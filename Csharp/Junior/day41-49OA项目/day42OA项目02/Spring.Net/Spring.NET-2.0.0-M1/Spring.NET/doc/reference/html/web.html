<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;22.&nbsp;Spring.NET Web Framework</title><link rel="stylesheet" href="styles/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_8103"><link rel="home" href="index.html" title="The Spring.NET Framework"><link rel="up" href="spring-web.html" title="Part&nbsp;III.&nbsp;The Web"><link rel="prev" href="spring-web.html" title="Part&nbsp;III.&nbsp;The Web"><link rel="next" href="ajax.html" title="Chapter&nbsp;23.&nbsp;ASP.NET AJAX"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.springframework.net/" title="The Spring Framework"><img style="border:none;" src="images/xdev-spring_logo.jpg"></img></a><a style="border:none;" href="http://www.springsource.com/" title="SpringSource"><img style="border:none;position:absolute;padding-top:5px;right:42px;" src="images/S2-banner-rhs.png"></img></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="web"></a>Chapter&nbsp;22.&nbsp;Spring.NET Web Framework</h2></div></div></div>
  

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-introduction"></a>22.1.&nbsp;Introduction to Spring.NET Web Framework</h2></div></div></div>
    

    <p>The Spring.NET Web Framework increases your productivity when you
    write ASP.NET WebForms applications by offering capabilities not found in
    other .NET web frameworks.</p>

    <p>The Spring.NET Web Framework makes it easy to write 'thin and clean'
    web applications. "Thin" refers to WebForm's role as a small as possible
    adapter between the HTML- based world of the web and the Object-oriented
    world of your application. The business logic does not reside in the web
    tier; it resides in the application layer with which your web form
    communicates. "Clean" refers to the framework's appropriate separation of
    concerns, separating web specific processing such as copying data out and
    into from element from a data model from calling into a buiness tier and
    redirecting to the next page. This results in an event-handler that does
    not contain any reference to UI elements thereby making it possible to
    test your event handler code in integration style tests. The Spring.NET
    Web Framework reduces the incidental complexity of common tasks in the web
    tier, for example, the conversion of HTML control data to objects and then
    vice-versa after the request is processed by the application layer.</p>

    <p>Highlights of Spring's Web framework are:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><a class="link" href="web.html#web-di" title="22.4.&nbsp;Dependency injection for ASP.NET pages">Dependency Injection</a>. Provided
        for all ASP.NET artifacts, inlcuding pages and user controls, modules,
        providers, and HTTP handlers. Your pages, controls, and so on do not
        require any dependency on Spring in order to be configured via
        dependency injection.</p>
      </li><li>
        <p><a class="link" href="web.html#web-databinding" title="22.7.&nbsp;Bidirectional data binding and data model management">Bidirectional data
        binding</a>. Allows you to declaratively define the data that will
        be marshaled out of your HTML and user controls and into a data model
        that in turn is generally submitted to the application layer. After
        the data model is updated in the application layer, those changes are
        automatically reflected in the HTML and user controls on post back.
        This process removes large amounts of tedious, error-prone boilerplate
        code.</p>
      </li><li>
        <p><a class="link" href="web.html#web-objectscope" title="22.5.&nbsp;Web object scopes">Web object scopes</a>. Can be
        defined at the application, session, or request scope. This capability
        makes it easy to inject, for example, a session scoped shopping cart,
        into your page without any lower level programming.</p>
      </li><li>
        <p><a class="link" href="web.html#web-databinding" title="22.7.&nbsp;Bidirectional data binding and data model management">Data model management</a>.
        Provides a mechanism similar to view state to help manage your data
        model. (While ASP.NET manages the view state of your form, it does not
        offer facilities to manage the data model that you build up to submit
        to the application layer.)</p>
      </li><li>
        <p><a class="link" href="web.html#web-validation-controls" title="22.11.1.&nbsp;Validation controls">UI-agnostic validation
        framework</a>. Enables you to declaratively define complex
        validation rules, for example, that take into account complex
        relationships in your data model. Spring's error controls easily
        render validation failure. Thus you can centralize your validation
        logic and also reuse it on the server side, for example, by using
        parameter validation advice described in the aspect library
        chapter.</p>
      </li><li>
        <p><a class="link" href="web.html#web-resultmapping" title="22.9.&nbsp;Result mapping">Externalized page navigation
        through result mapping</a>. Instead of hard-coding URLs and data to
        direct where a page should go next and what data should be carried
        along, you can define and configure result mappings externally that
        associate logical names and a URL (+ data). This capability also
        allows you to encrypt the values that are sent through
        Response.Redirect.</p>
      </li><li>
        <p>Improved <a class="link" href="web.html#web-localization" title="22.8.&nbsp;Localization and message sources">localization</a>
        and master page support. Provides advanced localization features
        (including image localization) and make it easy to declaratively
        configure which master page to apply to different parts of your web
        application.</p>
      </li></ul></div>

    <p>All you know about ASP.NET development still applies. Spring's
    approach is to 'embrace and extend' the basic ASP.NET programming model to
    make you as productive as possible.</p>

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
      <p>Support for ASP.NET MVC is planned for Spring.NET 2.0.</p>
    </td></tr></table></div>

    <p>This chapter describes the Spring.NET Web Framework in detail. The
    framework is not an all-or-nothing solution. For example, you can choose
    to use only dependency injection and bi-directional data binding. You can
    adopt the web framework incrementally, addressing problems areas in your
    current web application with a specific feature.</p>

    <p>The Spring.NET distribution ships with a Web Quick Start application
    and a complete reference application, SpringAir. The Web QuickStart is the
    best way to learn each Spring.NET Web Framework (also referred to in this
    document as Spring.Web) feature, by following simple examples. The
    SpringAir reference application has a Spring.Web-enabled frontend that
    uses many best practices for Spring.NET web applications, so refer to it
    as you are reading this (reference) material (see <a class="xref" href="springair.html" title="Chapter&nbsp;41.&nbsp;SpringAir - Reference Application">Chapter&nbsp;41, <i>SpringAir - Reference Application</i></a>).</p>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e7091"></a>22.2.&nbsp;Comparing Spring.NET and ASP.NET</h2></div></div></div>
    

    <p>Many developers dislike the ASP.NET programming model because
    currently it is not a "true MVC" (model-view-controller) implementation;
    controller-type logic within the page is too tightly coupled to the view.
    For example, event handlers within the page class typically have
    references to view elements, such as input controls, in many code behind
    locations, most typically the event handler. Controller-type logic, such
    as the code within page event handlers in ASP.NET, should not depend on
    the view elements.</p>

    <p>However, ASP.NET has its good points. Server-side forms and controls
    make developers significantly more productive and allow you to
    significantly simplify page markup. They also make cross-browser issues
    easier to deal with, as each control can make sure that it renders correct
    markup based on the user's browser. The ability to hook custom logic into
    the lifecycle of the page, as well as to customize the HTTP processing
    pipeline, are also very powerful features. The ability to interact with
    the strongly typed server-side controls instead of manipulating
    string-based HTTP request collections, such as Form and QueryString, is a
    much needed layer of abstraction in web development.</p>

    <p>Thus, instead of developing a new, pure and true MVC web framework
    as part of Spring.NET, Spring decided to extend ASP.NET so that most of
    its shortcomings are eliminated. With the introduction of a 'true MVC
    framework' to .NET there are several opportunities for integration with
    IoC containers such as Spring.NET. Furthermore, as Spring for Java has a
    very popular MVC framework, much of that experience and added value can be
    transliterated to help developers be more productive when using Spring's
    future support for ASP.NET MVC.</p>

    <p>Spring.Web also supports the application of the dependency injection
    principle to one's ASP.NET <code class="literal">Pages</code> and
    <code class="literal">Controls</code> as well as to HTTP modules and custom provider
    modules. Thus application developers can easily inject service
    dependencies into web controllers by leveraging the power of the
    Spring.NET IoC container. See <a class="link" href="web.html#web-di" title="22.4.&nbsp;Dependency injection for ASP.NET pages">Dependency Injection
    for ASP.NET Pages</a>.</p>

    <p>Event handlers in code-behind classes should not have to deal with
    ASP.NET UI controls directly. Such event handlers should rather work with
    the presentation model of the page, represented either as a hierarchy of
    domain objects or an ADO.NET <code class="literal">DataSet</code>. Spring.NET
    implemented a bidirectional data binding framework to handle the mapping
    of values to and from the controls on a page to the underlying data model.
    The data binding framework also transparently implements data type
    conversion and formatting, enabling application developers to work with
    fully typed data (domain) objects in the event handlers of code-behind
    files. See <a class="link" href="web.html#web-databinding" title="22.7.&nbsp;Bidirectional data binding and data model management">Bidirectional Data Binding and
    Model Management</a>.</p>

    <p>The Spring.NET Web Framework also addresses concerns about the flow
    of control through an application. Typical ASP.NET applications use
    <code class="literal">Response.Redirect</code> or <code class="literal">Server.Transfer</code>
    calls within <code class="literal">Page</code> logic to navigate to an appropriate
    page after an action is executed. This usage often leads to hard-coded
    target URLs in the <code class="literal">Page</code>, which is never a good thing.
    Result mapping solves this problem by allowing application developers to
    specify aliases for action results that map to target URLs based on
    information in an external configuration file that can easily be edited.
    See <a class="link" href="web.html#web-resultmapping" title="22.9.&nbsp;Result mapping">Result Mapping</a>.</p>

    <p>Standard localization support is also limited in versions of ASP.NET
    prior to ASP.NET 2.0. Even though Visual Studio 2003 generates a local
    resource file for each ASP.NET <code class="literal">Page</code> and user control,
    those resources are never used by the ASP.NET infrastructure. This means
    that application developers have to deal directly with resource managers
    whenever they need access to localized resources, which in the opinion of
    the Spring.NET team should not be the case. Spring.Web adds comprehensive
    support for localization using both local resource files and global
    resources that are configured within and for a Spring.NET container. See
    <a class="link" href="web.html#web-localization" title="22.8.&nbsp;Localization and message sources">Localization and Message
    Sources</a>.</p>

    <p>In addition to the aforementioned core features, Spring.Web ships
    with lesser features that might be useful to many application developers.
    Some of these additional features include back-ports of ASP.NET 2.0
    features that can be used with ASP.NET 1.1, such as Master Page support.
    See <a class="link" href="web.html#web-masterpages" title="22.6.&nbsp;Support for ASP.NET 1.1 master pages in Spring.Web">Master Pages in ASP.NET
    1.1</a> .</p>

    <p>To implement some features, the Spring.NET team had to extend (as in
    the object-oriented sense) the standard ASP.NET <code class="literal">Page</code>
    and <code class="literal">UserControl</code> classes. This means that in order to
    take advantage of the <span class="emphasis"><em>full</em></span> feature stack of
    Spring.Web (most notably bidirectional data binding, localization and
    result mapping), your code-behind classes must extend Spring.Web specific
    base classes such as <code class="literal">Spring.Web.UI.Page</code>. However,
    powerful features such as dependency injection for ASP.NET Pages,
    controls, and providers can be leveraged without having to extend
    Spring.Web-specific base classes. By taking advantage of
    <span class="emphasis"><em>some</em></span> of the more useful features offered by
    Spring.Web, you will be coupling the presentation tier of your
    application(s) to Spring.Web. The choice of whether or not this is
    appropriate is, of course, left to you.</p>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-contexts"></a>22.3.&nbsp;Automatic context loading and hierarchical contexts</h2></div></div></div>
    

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-configuration"></a>22.3.1.&nbsp;Configuration of a web application</h3></div></div></div>
      

      <p>Spring.Web builds on top of the Spring.NET IoC container, and
      makes heavy use (internally) of the easy pluggability and standardized
      configuration afforded by the IoC container. ASP.NET
      <code class="literal">Page</code>s and UserControls that make up a typical
      Spring.Web-enabled application are configured with the same standard
      Spring.NET XML configuration syntax used for non web objects. To
      integrate with the ASP.NET runtime you need to make a few modifications
      to your Web.config file.</p>

      <p>Spring.Web uses a custom <code class="literal">PageHandlerFactory</code>
      implementation to load and configure a Spring.NET IoC container, which
      is in turn used to locate an appropriate <code class="literal">Page</code> to
      handle a HTTP request. The <code class="literal">WebSupportModule</code>
      configures miscellaneous Spring infrastructure classes for use in a web
      environment, for example setting the storage strategy of
      <code class="literal">LogicalThreadContext</code> to be
      <code class="literal">HybridContextStorage</code>.</p>

      <p>The instantiation and configuration of the Spring.NET IoC
      container by the Spring.Web infrastructure is wholly transparent to
      application developers, who typically never have to explicitly
      instantiate and configure an IoC container manually (by, for example,
      using the <code class="literal">new</code> operator in C#). To effect the
      transparent bootstrapping of the IoC container, you need to insert the
      following configuration snippet into the root
      <code class="literal">Web.config</code> file of every Spring.Web-enabled web
      application. (You can of course change the <code class="literal">verb</code> and
      <code class="literal">path</code> properties from the values that are shown.)
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
          <p>If you are using the solution templates that ship with
          Spring.NET this configuration will be done for you automatically
          whent he solution is created.</p>
        </td></tr></table></div>

      <pre class="programlisting"><span style="color: #A31515">&lt;system.web&gt;</span>
    <span style="color: #A31515">&lt;httpHandlers&gt;</span>
        <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">verb</span>=<span style="color: #0000FF">"*"</span> <span style="color: #FF0000">path</span>=<span style="color: #0000FF">"*.aspx"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.PageHandlerFactory, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/httpHandlers&gt;</span>
    <span style="color: #A31515">&lt;httpModules&gt;</span>
        <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Spring"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.WebSupportModule, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/httpModules&gt;</span>
    ...
<span style="color: #A31515">&lt;/system.web&gt;</span>

</pre>

      <p>This snippet of standard ASP.NET configuration is only required in
      the <span class="emphasis"><em>root</em></span> directory of each Spring.Web web
      application (that is, in the <code class="literal">Web.config</code> file present
      in the top level virtual directory of an ASP.NET web
      application).</p>

      <p>The above XML configuration snippet directs the ASP.NET
      infrastructure to use Spring.NET's page factory, which in turn creates
      instances of the appropriate <code class="literal">.aspx</code>
      <code class="literal">Page</code>, possibly injects dependencies into that
      <code class="literal">Page</code> (as required), and then forwards the handling of
      the request to the <code class="literal">Page</code>.</p>

      <p>After the Spring.Web page factory is configured, you also need to
      define a root application context by adding a Spring.NET configuration
      section to that same <code class="literal">Web.config</code> file. The final
      configuration file should resemble the following; your exact
      configuration may vary in particulars.</p>

      <pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
<span style="color: #A31515">&lt;configuration&gt;</span>

    <span style="color: #A31515">&lt;configSections&gt;</span>
        <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"context"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.WebContextHandler, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
        <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
    <span style="color: #A31515">&lt;/configSections&gt;</span>

    <span style="color: #A31515">&lt;spring&gt;</span>
        <span style="color: #A31515">&lt;context&gt;</span>
            <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"~/Config/CommonObjects.xml"</span><span style="color: #A31515">/&gt;</span>
            <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"~/Config/CommonPages.xml"</span><span style="color: #A31515">/&gt;</span>

            <i style="color: #008000">&lt;!-- TEST CONFIGURATION --&gt;</i>
            <i style="color: #008000">&lt;!--
            &lt;resource uri="~/Config/Test/Services.xml"/&gt;
            &lt;resource uri="~/Config/Test/Dao.xml"/&gt;
            --&gt;</i>

            <i style="color: #008000">&lt;!-- PRODUCTION CONFIGURATION --&gt;</i>

            <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"~/Config/Production/Services.xml"</span><span style="color: #A31515">/&gt;</span>
            <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"~/Config/Production/Dao.xml"</span><span style="color: #A31515">/&gt;</span>

        <span style="color: #A31515">&lt;/context&gt;</span>
    <span style="color: #A31515">&lt;/spring&gt;</span>

    <span style="color: #A31515">&lt;system.web&gt;</span>
        <span style="color: #A31515">&lt;httpHandlers&gt;</span>
            <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">verb</span>=<span style="color: #0000FF">"*"</span> <span style="color: #FF0000">path</span>=<span style="color: #0000FF">"*.aspx"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.PageHandlerFactory, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
        <span style="color: #A31515">&lt;/httpHandlers&gt;</span>
        <span style="color: #A31515">&lt;httpModules&gt;</span>
            <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Spring"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.WebSupportModule, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
        <span style="color: #A31515">&lt;/httpModules&gt;</span>
    <span style="color: #A31515">&lt;/system.web&gt;</span>

<span style="color: #A31515">&lt;/configuration&gt;</span>
</pre>

      <p>Notes about the preceding configuration:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Define a custom configuration section handler for the
          <code class="literal">&lt;context</code><code class="code">&gt;</code> element. If you use
          Spring.NET for many applications on the same web server, it might be
          easier to move the whole definition of the Spring.NET section group
          to your <code class="literal">machine.config</code> file.</p>
        </li><li>
          <p>The custom configuration section handler is of the type
          <code class="literal">Spring.Context.Support.WebContextHandler</code> which in
          turn instantiates an IoC container of the type
          <code class="literal">Spring.Context.Support.WebApplicationContext</code>.
          This ensures that all features provided by Spring.Web, such as
          request and session-scoped object definitions, are handled
          properly.</p>
        </li><li>
          <p>Within the <code class="code">&lt;spring&gt;</code> element, define a root
          context element. Next, specify resource locations that contain the
          object definitions that are used within the web application (such as
          service or business tier objects) as child elements within the
          <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">&lt;context&gt;</span> element. Object definition
          resources can be fully-qualified paths or URLs, or non-qualified, as
          in the example above. Non-qualified resources are loaded using the
          default resource type for the context, which for the
          <code class="literal">WebApplicationContext</code> is the
          <code class="literal">WebResource</code> type.</p>
        </li><li>
          <p>The object definition resources do not have to be the same
          resource type (for example, all <code class="literal">file://</code>, all
          <code class="literal">http://</code>, all <code class="literal">assembly://</code>, and
          so on). This means that you can load some object definitions from
          resources embedded directly within application assemblies
          (<code class="literal">assembly://</code>) while continuing to load other
          object definitions from web resources that can be more easily
          edited.</p>
        </li></ul></div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e7174"></a>22.3.1.1.&nbsp;Configuration for IIS 7.0 on Windows Server 2008 and Windows
        Vista</h4></div></div></div>
        

        <p>There is some configuration that is specific to using IIS7, the
        appropriate code snippit to place in web.config shown below.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;system.webServer&gt;</span>
  <span style="color: #A31515">&lt;validation</span> <span style="color: #FF0000">validateIntegratedModeConfiguration</span>=<span style="color: #0000FF">"false"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;modules&gt;</span>
    <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Spring"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.WebSupportModule, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/modules&gt;</span>
  <span style="color: #A31515">&lt;handlers&gt;</span>
    <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"SpringPageHandler"</span> <span style="color: #FF0000">verb</span>=<span style="color: #0000FF">"*"</span> <span style="color: #FF0000">path</span>=<span style="color: #0000FF">"*.aspx"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.PageHandlerFactory, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"SpringContextMonitor"</span> <span style="color: #FF0000">verb</span>=<span style="color: #0000FF">"*"</span> <span style="color: #FF0000">path</span>=<span style="color: #0000FF">"ContextMonitor.ashx"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.ContextMonitor, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/handlers&gt;</span>
<span style="color: #A31515">&lt;/system.webServer&gt;</span></pre>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-context-hierarchy"></a>22.3.2.&nbsp;Context hierarchy</h3></div></div></div>
      

      <p>ASP.NET has a hierarchical configuration mechanism that enables
      application developers to override configuration settings specified at a
      higher level in the web application directory hierarchy with
      configuration settings specified at the lower level.</p>

      <p>For example, a web application's root
      <code class="literal">Web.config</code> file overrides settings from the (higher
      level) <code class="literal">machine.config</code> file. In the same fashion,
      settings specified within the <code class="literal">web.config</code> file within
      a subdirectory of a web application will override settings from the root
      <code class="literal">Web.config</code> and so on. You can also add seettings to
      lower level <code class="literal">Web.config</code> files that were not previously
      defined anywhere.</p>

      <p>Spring.Web leverages this ASP.NET feature to provide support for a
      context hierarchy. You can add new object definitions to lower level
      <code class="literal">Web.config</code> files or override existing ones per
      virtual directory.</p>

      <p>What this means to application developers is that one can easily
      componentize an application by creating a virtual directory per
      component and creating a custom context for each component that contains
      the necessary configuration info for that particular context. The
      configuration for a lower level component generally contains only those
      definitions for the pages that the component consists of and (possibly)
      overrides for some definitions from the root context (for example,
      menus).</p>

      <p>Because each such lower level component usually contains only a
      few object definitions, application developers are encouraged to embed
      those object definitions directly into the <code class="literal">Web.config</code>
      for the lower level context instead of relying on an external resource
      containing object definitions. This is easily accomplished by creating a
      component <code class="literal">Web.config</code> similar to the following
      one:</p>

      <pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
<span style="color: #A31515">&lt;configuration&gt;</span>

  <span style="color: #A31515">&lt;configSections&gt;</span>
    <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>
       <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objects"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.DefaultSectionHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
  <span style="color: #A31515">&lt;/configSections&gt;</span>

  <span style="color: #A31515">&lt;spring&gt;</span>
    <span style="color: #A31515">&lt;context</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.WebApplicationContext, Spring.Web"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"config://spring/objects"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/context&gt;</span>

    <span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyPage.aspx"</span> <span style="color: #FF0000">parent</span>=<span style="color: #0000FF">"basePage"</span><span style="color: #A31515">&gt;</span>
              <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"MyRootService"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"myServiceDefinedInRootContext"</span><span style="color: #A31515">/&gt;</span>
              <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"MyLocalService"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"myServiceDefinedLocally"</span><span style="color: #A31515">/&gt;</span>
              <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Results"</span><span style="color: #A31515">&gt;</span>
                 <i style="color: #008000">&lt;!-- ... --&gt;</i>
              <span style="color: #A31515">&lt;/property&gt;</span>
        <span style="color: #A31515">&lt;/object&gt;</span>
        <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myServiceDefinedLocally"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyCompany.MyProject.Services.MyServiceImpl, MyAssembly"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/objects&gt;</span>
  <span style="color: #A31515">&lt;/spring&gt;</span>
<span style="color: #A31515">&lt;/configuration&gt;</span></pre>

      <p>The <code class="literal">&lt;context/&gt;</code> element seen above
      (contained within the <code class="literal">&lt;spring/&gt;</code> element) simply
      tells the Spring.NET infrastructure code to load (its) object
      definitions from the <code class="literal">spring/objects</code> section of the
      web.config configuration file.</p>

      <p>If Spring.NET is used for multiple applications on the same
      server, you can avoid the need to specify the
      <code class="literal">&lt;configSections/&gt;</code> element as shown in the
      previous example, by moving the configuration handler definition for the
      <code class="literal">&lt;objects&gt;</code> element to a higher level (root)
      <code class="literal">Web.config</code> file, or even to the level of the
      <code class="literal">machine.config</code> file.</p>

      <p>This component-level context can reference definitions from its
      parent context(s). If a referenced object definition is not found in the
      current context, Spring.NET searches all ancestor contexts in the
      context hierarchy until it finds the object definition (or ultimately
      fails and throws an exception).</p>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-di"></a>22.4.&nbsp;Dependency injection for ASP.NET pages</h2></div></div></div>
    

    <p>An example of how Spring.Web builds on the capabilities of ASP.NET
    is the way in which Spring.Web has used the code-behind class of the
    <code class="literal">Page</code> mechanism to satisfy the
    <code class="literal">Controller</code> portion of the MVC architectural pattern. In
    MVC-based (web) applications, the <code class="literal">Controller</code> is
    typically a thin wrapper around one or more service objects. It is
    important that service object dependencies be easily injected into
    <code class="literal">Page</code> <code class="literal">Controller</code>s. Accordingly,
    Spring.Web provides first class support for dependency injection in
    ASP.NET <code class="literal">Page</code>s. Application developers can inject any
    required service object dependencies (and indeed any other dependencies)
    into their <code class="literal">Page</code>s using the standard Spring.NET
    configuration instead of having to rely on custom service locators or
    manual object lookups in a Spring.NET application context.</p>

    <p>After an application developer <a class="link" href="web.html#web-configuration" title="22.3.1.&nbsp;Configuration of a web application">configures</a> the Spring.NET web
    application context, the developer can easily create object definitions
    for the pages that compose that web application.</p>

    <pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"basePage"</span> <span style="color: #FF0000">abstract</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"MasterPageFile"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"~/Web/StandardTemplate.master"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/object&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Login.aspx"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Authenticator"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"authenticationService"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/object&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Default.aspx"</span> <span style="color: #FF0000">parent</span>=<span style="color: #0000FF">"basePage"</span><span style="color: #A31515">/&gt;</span>

<span style="color: #A31515">&lt;/objects&gt;</span></pre>

    <p>The preceding example contains three definitions:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>An abstract definition for the base page from which many other
        pages in the application will inherit. In this case, the definition
        simply specifies which page is to be referenced as the master page,
        but it typically also configures localization-related dependencies and
        root folders for images, scripts, and CSS stylesheets.</p>
      </li><li>
        <p>A login page that neither inherits from the base page nor
        references the master page. This page shows how to inject a service
        object dependency into a page instance (the
        <code class="literal">authenticationService</code> is defined elsewhere).</p>
      </li><li>
        <p>A default application page that, in this case, simply inherits
        from the base page in order to inherit the master page dependency, but
        apart from that it does not need any additional dependency injection
        configuration.</p>
      </li></ul></div>

    <p>The configuration of ASP.NET pages differs from the configuration of
    other .NET classes in the value passed to the <code class="literal">type</code>
    attribute. As can be seen in the above configuration snippet, the
    <code class="literal">type</code> name is actually the path to the
    <code class="literal">.aspx</code> file for the <code class="literal">Page</code>, relative to
    its directory context. When configuring other .NET classes one would
    specify at minimum the fully qualified type name and the partial assembly
    name.</p>

    <p>In the case of the above example, those definitions are in the root
    context ,so <code class="literal">Login.aspx</code> and
    <code class="literal">Default.aspx</code> files also must be located in the root of
    the web application's virtual directory. The master page is defined using
    an absolute path because it could conceivably be referenced from child
    contexts that are defined within subdirectories of the web
    application.</p>

    <p>The definitions for the <code class="literal">Login</code> and
    <code class="literal">Default</code> pages do not specify either of the
    <code class="literal">id</code> and <code class="literal">name</code> attributes, in marked
    contrast to typical object definitions in Spring.NET, where the
    <code class="literal">id</code> or <code class="literal">name</code> attributes are usually
    mandatory (although not always, as in the case of inner object
    definitions). In the case of Spring.Web manged <code class="literal">Page</code>
    instances, one typically wants to use the name of the
    <code class="literal">.aspx</code> file name as the identifier. If an
    <code class="literal">id</code> is not specified, the Spring.Web infrastructure will
    simply use the name of the <code class="literal">.aspx</code> file as the object
    identifier (minus any leading path information, and minus the file
    extension too).</p>

    <p>Nothing prevents an application developer from specifying an
    <code class="literal">id</code> or <code class="literal">name</code> value explicitly;
    explicit naming can be useful when, for example, one wants to expose the
    same page multiple times using a slightly different configuration, such as
    Add / Edit pages. To use abstract object definitions and have your page
    inherit from them, use the <code class="literal">name</code> attribute instead of
    the <code class="literal">id</code> attribute on the abstract object
    definition.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-di-controls"></a>22.4.1.&nbsp;Injecting dependencies into controls</h3></div></div></div>
      

      <p>Spring.Web also allows application developers to inject
      dependencies into controls (both user controls and standard controls)
      that are contained within a page. You can accomplish this globally for
      all controls of a particular <code class="literal">Type</code> by using the
      location of the <code class="literal">.ascx</code> as the object type identifier.
      This process is similar to injecting into <code class="literal">.aspx
      </code>pages, shown above.</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"~/controls/MyControl.ascx"</span> <span style="color: #FF0000">abstract</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">&gt;</span>
   <i style="color: #008000">&lt;!-- inject dependencies here... --&gt;</i>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
          <p>In either case, be sure to mark the object definition as
          <code class="literal">abstract</code> (by adding
          <code class="literal">abstract="true"</code> to the attribute list of the
          <code class="literal">&lt;object/&gt;</code> element).</p>
        </td></tr></table></div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-di-modules"></a>22.4.2.&nbsp;Injecting dependencies into custom HTTP modules</h3></div></div></div>
      

      <p>You can inject dependencies into custom HTTP modules by using the
      class
      <code class="literal">Spring.Context.Support.HttpApplicationConfigurer</code>. You
      register your custom HTTP module as you would normally; for example, a
      module of the type <code class="literal">HtmlCommentAppenderModule</code>, taken
      from the Web Quick Start, appends additional comments into the http
      response. It is registered as follows:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;httpModules&gt;</span>
  <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"HtmlCommentAppender"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"HtmlCommentAppenderModule"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/httpModules&gt;</span></pre>

      <p>To configure this module, you use naming conventions to identify
      the module name with configuration instructions in the Spring
      configuration file. The <code class="literal">ModuleTemplates</code> property of
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">HttpApplicationConfigurer</span> is a dictionary that
      takes as a key the name of the HTTP module, in this case
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">HtmlCommentAppender</span>, and the Spring object
      definition that describes how to perform dependency injection. The
      object definition is in the standard &lt;object/&gt; style that you are
      used to normally when configuring an object with Spring. An example is
      shown below. HttpApplicationConfigurer' that configures the
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">HtmlCommentAppender's</span>
      <span class="property">AppendText</span> property.</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"HttpApplicationConfigurer"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.HttpApplicationConfigurer, Spring.Web"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ModuleTemplates"</span><span style="color: #A31515">&gt;</span>
     <span style="color: #A31515">&lt;dictionary&gt;</span>
       <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"HtmlCommentAppender"</span><span style="color: #A31515">&gt;</span> <i style="color: #008000">&lt;!-- this name must match the module name --&gt;</i>
         <span style="color: #A31515">&lt;object&gt;</span>
           <i style="color: #008000">&lt;!-- select "view source" in your browser on any page to see the appended html comment --&gt;</i>
           <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"AppendText"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"My configured comment!"</span><span style="color: #A31515"> /&gt;</span>
         <span style="color: #A31515">&lt;/object&gt;</span>
       <span style="color: #A31515">&lt;/entry&gt;</span>
     <span style="color: #A31515">&lt;/dictionary&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <p>You can see this example in action in the Web Quick Start.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-di-handler"></a>22.4.3.&nbsp;Injecting dependencies into HTTP handlers and handler
      factories</h3></div></div></div>
      

      <p>Performing dependency injection on instances of
      <code class="literal">IHttpHandlers</code> and <code class="literal">IHttpHandlerFactory
      </code>allows for a fully Spring-managed
      <code class="literal">&lt;httpHandlers&gt;</code> configuration section. To
      perform dependency injection onan <code class="literal">IHttpHandler</code> or
      <code class="literal">IHttpHandlerFactory,</code> register Spring's
      <code class="literal">MappingHandlerFactory</code> with a specific path or
      wildcard string (that is, *.aspx) using the standard configuration of an
      <code class="literal">&lt;httpHandler&gt;</code> in web.config. For
      example:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;system.web&gt;</span>
  <span style="color: #A31515">&lt;httpHandlers&gt;</span>
    <i style="color: #008000">&lt;!--
      the lines below map *any* request ending with *.ashx or *.whatever
      to the global(!) MappingHandlerFactory. Further "specialication"
      of which handler to map to is done within MappingHandlerFactory's configuration -
      use MappingHandlerFactoryConfigurer for this (see below)
    --&gt;</i>
    <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">verb</span>=<span style="color: #0000FF">"*"</span> <span style="color: #FF0000">path</span>=<span style="color: #0000FF">"*.ashx"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.MappingHandlerFactory, Spring.Web"</span> <span style="color: #FF0000">validate</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">verb</span>=<span style="color: #0000FF">"*"</span> <span style="color: #FF0000">path</span>=<span style="color: #0000FF">"*.whatever"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.MappingHandlerFactory, Spring.Web"</span> <span style="color: #FF0000">validate</span>=<span style="color: #0000FF">"false"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/httpHandlers&gt;</span>
<span style="color: #A31515">&lt;/system.web&gt;</span></pre>

      <p>Spring's MappingHandlerFactory serves a layer of indirection so
      that you can configure multiple handler mappings with Spring. You do
      this by configuring a IDictionary HandlerMap property on the class
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">MappingHandlerFactoryConfigurer</span>. The dictionary
      key is a regular expression that matches the request URL, and the value
      is a reference to the name of a Spring managed instance of an
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IHttpHandler</span> or
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IHttpHandlerFactory</span> . The Spring managed instance
      is configured via dependency injection using the standard
      &lt;object/&gt; XML configuraiton schema.</p>

      <p>The configuration of
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">MappingHandlerFactoryConfigurer</span> is shown:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>

    <i style="color: #008000">&lt;!-- configures the global GenericHandlerFactory instance --&gt;</i>
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"mappingHandlerFactoryConfigurer"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.MappingHandlerFactoryConfigurer, Spring.Web"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"HandlerMap"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;dictionary&gt;</span>
                <i style="color: #008000">&lt;!-- map any request ending with *.whatever to NoOpHandler --&gt;</i>
                <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"\.whatever$"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"myCustomHandler"</span><span style="color: #A31515"> /&gt;</span>
                <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"\.ashx$"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"standardHandlerFactory"</span><span style="color: #A31515"> /&gt;</span>
            <span style="color: #A31515">&lt;/dictionary&gt;</span>
        <span style="color: #A31515">&lt;/property&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>

    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"standardHandlerFactory"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.DefaultHandlerFactory, Spring.Web"</span><span style="color: #A31515"> /&gt;</span>

    <i style="color: #008000">&lt;!-- defines a standard singleton that will handle *.whatever requests --&gt;</i>
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myCustomHandler"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyCustomHttpHandler, App_Code"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"MessageText"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"This text is injected via Spring"</span><span style="color: #A31515"> /&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>

    <i style="color: #008000">&lt;!--
        used for configuring ~/DemoHandler.ashx custom handler
        note, that this is an abstract definition because 'type' is not specified
    --&gt;</i>
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"DemoHandler.ashx"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"OutputText"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;value&gt;</span>This text is injected via Spring<span style="color: #A31515">&lt;/value&gt;</span>
        <span style="color: #A31515">&lt;/property&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>
<span style="color: #A31515">&lt;/objects&gt;</span></pre>

      <p>Spring's <code class="literal">DefaultHandlerFactory</code> uses the .NET
      class <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">System.Web.UI.SimpleHandlerFactory</span> to
      create handler instances and configures each instance by using an object
      definition whose name matches the request URL's filename. The abstract
      object definition of <code class="literal">DemoHandler.ashx</code> is an example
      of this approach. You can also configure standard classes that implement
      the <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IHttpHandler </span>interface as demonstrated in the
      example above for the class
      <code class="literal">MyCustomHttpHandler</code>.</p>

      <p>Refer to the Web Quick Start application too see this in
      action.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e7302"></a>22.4.4.&nbsp;Injecting dependencies in custom ASP.NET providers</h3></div></div></div>
      

      <p>Custom providers can be configured via dependency injection with
      Spring. The approach to configuration for providers is to use a family
      of adapters that correspond 1-to-1 with the standard ASP.NET providers
      that are registered via the standard ASP.NET mechanism. The adapters
      inherit from their correspondingly named provider class in the .NET
      class library.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>MembershipProviderAdapter</p>
        </li><li>
          <p>ProfileProviderAdapter</p>
        </li><li>
          <p>RoleProviderAdapter</p>
        </li><li>
          <p>SiteMapProviderAdapter</p>
        </li></ul></div>

      <p>Here is an example of how to register the adapter for membership
      providers.</p>

      <pre class="programlisting">        <span style="color: #A31515">&lt;membership</span> <span style="color: #FF0000">defaultProvider</span>=<span style="color: #0000FF">"mySqlMembershipProvider"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;providers&gt;</span>
                <span style="color: #A31515">&lt;clear/&gt;</span>
                <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">connectionStringName</span>=<span style="color: #0000FF">""</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"</span><span class="bold"><strong>mySqlMembershipProvider</strong></span>" type="Spring.Web.Providers.MembershipProviderAdapter, Spring.Web"/&gt;
            <span style="color: #A31515">&lt;/providers&gt;</span>
        <span style="color: #A31515">&lt;/membership&gt;</span></pre>

      <p>The name of the provider must match the name of the object in the
      Spring configuration that will serve as the actual provider
      implementation. Configurable versions of the providers are found in
      ASP.NET so that you can use the full functionality of Spring to
      configure these standard provider implementations, by using property
      placeholders, and so on. The providers are:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>ConfigurableActiveDirectoryMembershipProvider</p>
        </li><li>
          <p>ConfigurableSqlMembershipProvider</p>
        </li><li>
          <p>ConfigurableSqlProfileProvider</p>
        </li><li>
          <p>ConfigurableSqlRoleProvider</p>
        </li><li>
          <p>ConfigurableXmlSiteMapProvider</p>
        </li></ul></div>

      <p>This example configuration taken from the Web Quick Start
      application sets the description property and connection string.</p>

      <pre class="programlisting">    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"</span><span class="bold"><strong>mySqlMembershipProvider</strong></span>" type="Spring.Web.Providers.ConfigurableSqlMembershipProvider"&gt;
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"connectionStringName"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"MyLocalSQLServer"</span><span style="color: #A31515"> /&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"parameters"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;name-values&gt;</span>
                <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"description"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"membershipprovider description"</span><span style="color: #A31515"> /&gt;</span>
            <span style="color: #A31515">&lt;/name-values&gt;</span>
        <span style="color: #A31515">&lt;/property&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span></pre>

      <p>Your own custom providers of course will contain additional
      configuration specific to your implementation.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-controlling-di"></a>22.4.5.&nbsp;Customizing control dependency injection</h3></div></div></div>
      

      <p>You may need to customize Spring.Web's dependency injection
      processing, such as when using GridViews or other complex 3rd party
      custom controls. Often these controls are not configured using
      dependency injection but Spring considers each control and its nested
      child controls as candidates for DI. With very large (&gt;1000) nested
      controls that candidate evaluation process can unecessarily slow down
      your page. To address this problem, you can tell Spring to not attempt
      to configure via DI the sections of your page that contain these
      controls or implementing the interface
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">ISupportsWebDependencyInjection</span> and explicitly
      ask Spring to inject dependencies on a particular contorol. These
      approaches are shown below</p>

      <pre class="programlisting">[C#]
<span style="color: #0000FF">class</span> MyControl : Control, ISupportsWebDependencyInjection
{
  <span style="color: #0000FF">private</span> IApplicationContext _defaultApplicationContext;

  <span style="color: #0000FF">public</span> IApplicationContext DefaultApplicationContext
  {
    <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> _defaultApplicationContext; }
    <span style="color: #0000FF">set</span> { _defaultApplicationContext = <span style="color: #0000FF">value</span>; }
  }

  <span style="color: #0000FF">override</span> <span style="color: #0000FF">protected</span> AddedControl( Control control, <span style="color: #0000FF">int</span> index )
  {
    <i style="color: #008000">// handle DI for children ourselves -</i>
    <i style="color: #008000">// defaults to a call to InjectDependenciesRecursive</i>
    WebUtils.InjectDependenciesRecursive( _defaultApplicationContext, control );
    <span style="color: #0000FF">base</span>.AddedControl( control, index );
  }
}</pre>

      <p>A Spring server control, <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">Panel</span>, provides an
      easier way to turn off dependency injection for parts of your
      page:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;spring:Panel</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span>
   <span style="color: #FF0000">suppressDependencyInjection</span>=<span style="color: #0000FF">"true"</span>
   <span style="color: #FF0000">renderContainerTag</span>=<span style="color: #0000FF">"false"</span><span style="color: #A31515">&gt;</span>

   .. put your heavy controls here - they won't be touched by DI

<span style="color: #A31515">&lt;/spring:Panel&gt;</span></pre>

      <p>By wrapping the performance-sensitive parts of your page within
      this panel, you can easily turn off DI by setting the attribute
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">suppressDependencyInjection</span> to true. By default
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">&lt;spring:Panel/&gt;</span> will not render a container
      tag (&lt;div&gt;, &lt;span&gt;, and so on). You can modify this behavior
      by setting the <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">attribute renderContainerTag</span>
      accordingly.</p>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-objectscope"></a>22.5.&nbsp;Web object scopes</h2></div></div></div>
    

    <p>Spring.NET web applications support an additional attribute within
    object definition elements that allows you to control the scope of an
    object: </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyType, MyAssembly"</span> <span style="color: #FF0000">scope</span>=<span style="color: #0000FF">"application | session | request"</span><span style="color: #A31515">/&gt;</span></pre><p>Possible
    values for the scope attribute are <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">application</span>,
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">session,</span> and <code class="code">request</code>. Application
    scope is the default, and is used for all objects with an undefined scope
    attribute. This scope creates a single instance of an object for the
    duration of the IIS application, so that the objects works exactly like
    the standard singleton objects in non-web applications. Session scope
    defines objects so that an instance is created for each HttpSession. This
    scope is ideal for objects such as user profile, shopping cart, and so on
    that you want bound to a single user.</p>

    <p>Request scope creates one instance per HTTP request. Unlike calls to
    prototype objects, calls to
    <code class="literal">IApplicationContext.GetObject</code> return the same instance
    of the request-scoped object during a single HTTP request. This allows
    you, for example, to inject the same request-scoped object into multiple
    pages and then use server-side transfer to move from one page to another.
    As all the pages are executed within the single HTTP request in this case,
    they share the same instance of the injected object.</p>

    <p>Objects can only reference other objects that are in the same or
    broader scope. This means that application-scoped objects can only
    reference other application-scoped objects, session-scoped objects can
    reference both session and application-scoped objects, and request-scoped
    objects can reference other request-, session-, or application-scoped
    objects. Also, prototype objects (including all ASP.NET web pages defined
    within Spring.NET context) can reference singleton objects from any scope,
    as well as other prototype objects.</p>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-masterpages"></a>22.6.&nbsp;Support for ASP.NET 1.1 master pages in Spring.Web</h2></div></div></div>
    

    <p>Support for ASP.NET 1.1 master pages in Spring.Web is very similar
    to the support for master pages in ASP.NET 2.0.</p>

    <p>A web developer can define a layout template for the site as a
    master page and specify content placeholders that other pages can then
    reference and populate. A sample master page
    (<code class="literal">MasterLayout.ascx</code>) could look like this:</p>

    <pre class="programlisting"><span style="color: #A31515">&lt;%@</span> <span style="color: #FF0000">Control</span> <span style="color: #FF0000">language</span>=<span style="color: #0000FF">"c#"</span> <span style="color: #FF0000">Codebehind</span>=<span style="color: #0000FF">"MasterLayout.ascx.cs"</span> <span style="color: #FF0000">AutoEventWireup</span>=<span style="color: #0000FF">"false"</span> <span style="color: #FF0000">Inherits</span>=<span style="color: #0000FF">"MyApp.Web.UI.MasterLyout"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;%@</span> <span style="color: #FF0000">Register</span> <span style="color: #FF0000">TagPrefix</span>=<span style="color: #0000FF">"spring"</span> <span style="color: #FF0000">Namespace</span>=<span style="color: #0000FF">"Spring.Web.UI.Controls"</span> <span style="color: #FF0000">Assembly</span>=<span style="color: #0000FF">"Spring.Web"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;!DOCTYPE</span> <span style="color: #FF0000">HTML</span> <span style="color: #FF0000">PUBLIC</span> <span style="color: #FF0000">"-//W3C//DTD</span> <span style="color: #FF0000">HTML</span> <span style="color: #FF0000">4.0</span> <span style="color: #FF0000">Transitional//EN"</span><span style="color: #A31515"> &gt;</span>
<span style="color: #A31515">&lt;html&gt;</span>
    <span style="color: #A31515">&lt;head&gt;</span>
        <span style="color: #A31515">&lt;title&gt;</span>Master Page<span style="color: #A31515">&lt;/title&gt;</span>
        <span style="color: #A31515">&lt;link</span> <span style="color: #FF0000">rel</span>=<span style="color: #0000FF">"stylesheet"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"text/css"</span> <span style="color: #FF0000">href</span>=<span style="color: #0000FF">"&lt;%= Context.Request.ApplicationPath %&gt;/css/styles.css"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;spring:ContentPlaceHolder</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"head"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/head&gt;</span>
    <span style="color: #A31515">&lt;body&gt;</span>
        <span style="color: #A31515">&lt;form</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;table</span> <span style="color: #FF0000">cellPadding</span>=<span style="color: #0000FF">"3"</span> <span style="color: #FF0000">width</span>=<span style="color: #0000FF">"100%"</span> <span style="color: #FF0000">border</span>=<span style="color: #0000FF">"1"</span><span style="color: #A31515">&gt;</span>
                <span style="color: #A31515">&lt;tr&gt;</span>
                    <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">colspan</span>=<span style="color: #0000FF">"2"</span><span style="color: #A31515">&gt;</span>
                        <span style="color: #A31515">&lt;spring:ContentPlaceHolder</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"title"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
                            <i style="color: #008000">&lt;!-- default title content --&gt;</i>
                        <span style="color: #A31515">&lt;/spring:ContentPlaceHolder&gt;</span>
                    <span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;/tr&gt;</span>
                <span style="color: #A31515">&lt;tr&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span>
                        <span style="color: #A31515">&lt;spring:ContentPlaceHolder</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"leftSidebar"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
                            <i style="color: #008000">&lt;!-- default left side content --&gt;</i>
                        <span style="color: #A31515">&lt;/spring:ContentPlaceHolder&gt;</span>
                    <span style="color: #A31515">&lt;/td&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span>
                        <span style="color: #A31515">&lt;spring:ContentPlaceHolder</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"main"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
                            <i style="color: #008000">&lt;!-- default main area content --&gt;</i>
                        <span style="color: #A31515">&lt;/spring:ContentPlaceHolder&gt;</span>
                    <span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;/tr&gt;</span>
            <span style="color: #A31515">&lt;/table&gt;</span>
        <span style="color: #A31515">&lt;/form&gt;</span>
    <span style="color: #A31515">&lt;/body&gt;</span>
<span style="color: #A31515">&lt;/html&gt;</span></pre>

    <p>In the preceding code, the master page defines the overall layout
    for the page, in addition to four content placeholders that other pages
    can override. The master page can also include default content within the
    placeholder that will be displayed if a derived page does not override the
    placeholder.</p>

    <p>A page that uses this master page (Child.aspx) might look like
    this:</p>

    <pre class="programlisting"><span style="color: #A31515">&lt;%@</span> <span style="color: #FF0000">Register</span> <span style="color: #FF0000">TagPrefix</span>=<span style="color: #0000FF">"spring"</span> <span style="color: #FF0000">Namespace</span>=<span style="color: #0000FF">"Spring.Web.UI.Controls"</span> <span style="color: #FF0000">Assembly</span>=<span style="color: #0000FF">"Spring.Web"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;%@</span> <span style="color: #FF0000">Page</span> <span style="color: #FF0000">language</span>=<span style="color: #0000FF">"c#"</span> <span style="color: #FF0000">Codebehind</span>=<span style="color: #0000FF">"Child.aspx.cs"</span> <span style="color: #FF0000">AutoEventWireup</span>=<span style="color: #0000FF">"false"</span> <span style="color: #FF0000">Inherits</span>=<span style="color: #0000FF">"ArtFair.Web.UI.Forms.Child"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;html&gt;</span>
    <span style="color: #FF0000">&lt;body&gt;</span>

        <span style="color: #FF0000">&lt;spring:Content</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"leftSidebarContent"</span> <span style="color: #FF0000">contentPlaceholderId</span>=<span style="color: #0000FF">"leftSidebar"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
            <i style="color: #008000">&lt;!-- left sidebar content --&gt;</i>
        <span style="color: #A31515">&lt;/spring:Content&gt;</span>

        <span style="color: #A31515">&lt;spring:Content</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"mainContent"</span> <span style="color: #FF0000">contentPlaceholderId</span>=<span style="color: #0000FF">"main"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
            <i style="color: #008000">&lt;!-- main area content --&gt;</i>
        <span style="color: #A31515">&lt;/spring:Content&gt;</span>

    <span style="color: #A31515">&lt;/body&gt;</span>
<span style="color: #A31515">&lt;/html&gt;</span></pre>

    <p>The <code class="literal">&lt;spring:Content/&gt;</code> control in the
    example uses the <code class="literal">contentPlaceholderId</code> attribute
    (property) to specify exactly which placeholder from the master page is to
    be overridden. Because this particular page does not define content
    elements for the head and title placeholders, the content elements are
    defined by the default content supplied in the master page.</p>

    <p>Both the <code class="literal">ContentPlaceHolder</code> and
    <code class="literal">Content</code> controls can contain any valid ASP.NET markup:
    HTML, standard ASP.NET controls, user controls, and so on.</p>

    <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
      <p>Technically, the <code class="literal">&lt;html&gt;</code> and
      <code class="literal">&lt;body&gt;</code> tags from the previous example are not
      strictly necessary because they are already defined in the master page.
      However, if these tags are omitted, Visual Studio 2003 complains about a
      schema, and IntelliSense does not work. So it is much easier to work in
      the HTML view if those tags are included. They are ignored when the page
      is rendered.</p>
    </td></tr></table></div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-childpage-linking"></a>22.6.1.&nbsp;Linking child pages to their master page file</h3></div></div></div>
      

      <p>The <code class="literal">Spring.Web.UI.Page</code> class exposes a property
      called <code class="literal">MasterPageFile</code>, which you can use to specify
      the master page.</p>

      <p>The recommended way to do this is by leveraging the Spring.NET IoC
      container and creating definitions similar to the following:</p>

      <pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8" ?&gt;
<span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"basePage"</span> <span style="color: #FF0000">abstract</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"MasterPageFile"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"~/MasterLayout.ascx"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/object&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Child.aspx"</span> <span style="color: #FF0000">parent</span>=<span style="color: #0000FF">"basePage"</span><span style="color: #A31515">&gt;</span>
      <i style="color: #008000">&lt;!-- inject other objects that page needs --&gt;</i>
  <span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;/objects&gt;</span></pre>

      <p>This approach allows application developers to change the master
      page for a number of pages within a web application. You can still
      override the master page on a per context or per page basis by creating
      a new abstract page definition within a child context, or by specifying
      the <code class="literal">MasterPageFile</code> property directly.</p>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-databinding"></a>22.7.&nbsp;Bidirectional data binding and data model management</h2></div></div></div>
    

    <p>The existing data binding support in ASP.NET is one-way only. It
    allows application developers to bind page controls to the data model and
    display information from the data model, but it does not permit the
    extraction of values from the controls when the form is submitted.
    Spring.Web adds bidirectional data binding to ASP.NET by allowing
    developers to specify data binding rules for their page, and by
    automatically evaluating configured data binding rules at the appropriate
    time in the page's lifecycle.</p>

    <p>ASP.NET does support model management within the postbacks. It has a
    ViewState management, but that takes care of the control state only and
    does not address the state of any presentation model objects to which
    these controls are bound. To manage a model within ASP.NET, developers
    typically use an HTTP session object to store the model between the
    postbacks. This process results in boilerplate code that can and should be
    eliminated, which is exactly what Spring.Web does by providing a simple
    set of model management methods.</p>

    <p>To take advantage of the bidirectional data binding and model
    management support provided by Spring.Web, you <span class="emphasis"><em>will</em></span>
    have to couple your presentation layer to Spring.Web; this is because
    features <span class="emphasis"><em>require </em></span>you to extend a
    <code class="literal">Spring.Web.UI.Page</code> instead of the usual
    <code class="literal">System.Web.UI.Page</code> class.</p>

    <p>Spring.Web data binding is very easy to use. Simply override the
    protected <code class="literal">InitializeDataBindings</code> method and configure
    data binding rules for the page. You also need to override three model
    management methods: <code class="literal">InitializeModel</code>,
    <code class="literal">LoadModel</code> and <code class="literal">SaveModel</code>. This
    process is illustrated by an example from the SpringAir reference
    application. First, take a look at the page markup:</p><pre class="programlisting"><span style="color: #A31515">&lt;%@</span> <span style="color: #FF0000">Page</span> <span style="color: #FF0000">Language</span>=<span style="color: #0000FF">"c#"</span> <span style="color: #FF0000">Inherits</span>=<span style="color: #0000FF">"TripForm"</span> <span style="color: #FF0000">CodeFile</span>=<span style="color: #0000FF">"TripForm.aspx.cs"</span> <span style="color: #FF0000">%&gt;</span>

<span style="color: #FF0000">&lt;asp:Content</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"body"</span> <span style="color: #FF0000">ContentPlaceHolderID</span>=<span style="color: #0000FF">"body"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;div</span> <span style="color: #FF0000">style</span>=<span style="color: #0000FF">"text-align: center"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;h4&gt;</span><span style="color: #A31515">&lt;asp:Label</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"caption"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span><span style="color: #A31515">&lt;/asp:Label&gt;</span><span style="color: #A31515">&lt;/h4&gt;</span>
        <span style="color: #A31515">&lt;table&gt;</span>
            <span style="color: #A31515">&lt;tr</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"formLabel"</span><span style="color: #A31515">&gt;</span>
                <span style="color: #A31515">&lt;td&gt;</span>&amp;nbsp;<span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">colspan</span>=<span style="color: #0000FF">"3"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;spring:RadioButtonGroup</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"tripMode"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
                        <span style="color: #A31515">&lt;asp:RadioButton</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"OneWay"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515"> /&gt;</span>
                        <span style="color: #A31515">&lt;asp:RadioButton</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"RoundTrip"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515"> /&gt;</span>
                    <span style="color: #A31515">&lt;/spring:RadioButtonGroup&gt;</span>
                <span style="color: #A31515">&lt;/td&gt;</span>
            <span style="color: #A31515">&lt;/tr&gt;</span>
            <span style="color: #A31515">&lt;tr&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"formLabel"</span> <span style="color: #FF0000">align</span>=<span style="color: #0000FF">"right"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;asp:Label</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"leavingFrom"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515"> /&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">nowrap</span>=<span style="color: #0000FF">"nowrap"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;asp:DropDownList</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"leavingFromAirportCode"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515"> /&gt;</span>
                <span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"formLabel"</span> <span style="color: #FF0000">align</span>=<span style="color: #0000FF">"right"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;asp:Label</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"goingTo"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515"> /&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">nowrap</span>=<span style="color: #0000FF">"nowrap"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;asp:DropDownList</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"goingToAirportCode"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515"> /&gt;</span>
                <span style="color: #A31515">&lt;/td&gt;</span>
            <span style="color: #A31515">&lt;/tr&gt;</span>
            <span style="color: #A31515">&lt;tr&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"formLabel"</span> <span style="color: #FF0000">align</span>=<span style="color: #0000FF">"right"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;asp:Label</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"leavingOn"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515"> /&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">nowrap</span>=<span style="color: #0000FF">"nowrap"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;spring:Calendar</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"departureDate"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">Width</span>=<span style="color: #0000FF">"75px"</span> <span style="color: #FF0000">AllowEditing</span>=<span style="color: #0000FF">"true"</span> <span style="color: #FF0000">Skin</span>=<span style="color: #0000FF">"system"</span><span style="color: #A31515"> /&gt;</span>
                <span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"formLabel"</span> <span style="color: #FF0000">align</span>=<span style="color: #0000FF">"right"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;asp:Label</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"returningOn"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515"> /&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">nowrap</span>=<span style="color: #0000FF">"nowrap"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;div</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"returningOnCalendar"</span><span style="color: #A31515">&gt;</span>
                        <span style="color: #A31515">&lt;spring:Calendar</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"returnDate"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">Width</span>=<span style="color: #0000FF">"75px"</span> <span style="color: #FF0000">AllowEditing</span>=<span style="color: #0000FF">"true"</span> <span style="color: #FF0000">Skin</span>=<span style="color: #0000FF">"system"</span><span style="color: #A31515"> /&gt;</span>
                    <span style="color: #A31515">&lt;/div&gt;</span>
                <span style="color: #A31515">&lt;/td&gt;</span>
            <span style="color: #A31515">&lt;/tr&gt;</span>
            <span style="color: #A31515">&lt;tr&gt;</span>
                <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"buttonBar"</span> <span style="color: #FF0000">colspan</span>=<span style="color: #0000FF">"4"</span><span style="color: #A31515">&gt;</span>
                    <span style="color: #A31515">&lt;br/&gt;</span>
                    <span style="color: #A31515">&lt;asp:Button</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"findFlights"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">/&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
            <span style="color: #A31515">&lt;/tr&gt;</span>
        <span style="color: #A31515">&lt;/table&gt;</span>
    <span style="color: #A31515">&lt;/div&gt;</span>

 <span style="color: #A31515">&lt;/asp:Content&gt;</span>

</pre><p>Ignore for the moment the fact that none of the label
    controls have text defined; defining label controls is described later
    when we discuss localization in Spring.NET. For the purposes of the
    current discussion, a number of input controls are defined:
    <code class="literal">tripMode</code> radio button group,
    <code class="literal">leavingFromAirportCode</code> and
    <code class="literal">goingToAirportCode</code> dropdown lists, as well as two
    Spring.NET Calendar controls, <code class="literal">departureDate</code> and
    <code class="literal">returnDate</code>.</p>

    <p>Take a look at the model to which you bind the form:</p><pre class="programlisting"><span style="color: #0000FF">namespace</span> SpringAir.Domain
{
    [Serializable]
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> Trip
    {
        <i style="color: #008000">// fields</i>
        <span style="color: #0000FF">private</span> TripMode mode;
        <span style="color: #0000FF">private</span> TripPoint startingFrom;
        <span style="color: #0000FF">private</span> TripPoint returningFrom;

        <i style="color: #008000">// constructors</i>
        <span style="color: #0000FF">public</span> Trip()
        {
            <span style="color: #0000FF">this</span>.mode = TripMode.RoundTrip;
            <span style="color: #0000FF">this</span>.startingFrom = <span style="color: #0000FF">new</span> TripPoint();
            <span style="color: #0000FF">this</span>.returningFrom = <span style="color: #0000FF">new</span> TripPoint();
        }

        <span style="color: #0000FF">public</span> Trip(TripMode mode, TripPoint startingFrom, TripPoint returningFrom)
        {
            <span style="color: #0000FF">this</span>.mode = mode;
            <span style="color: #0000FF">this</span>.startingFrom = startingFrom;
            <span style="color: #0000FF">this</span>.returningFrom = returningFrom;
        }

        <i style="color: #008000">// properties</i>
        <span style="color: #0000FF">public</span> TripMode Mode
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.mode; }
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.mode = <span style="color: #0000FF">value</span>; }
        }

        <span style="color: #0000FF">public</span> TripPoint StartingFrom
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.startingFrom; }
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.startingFrom = <span style="color: #0000FF">value</span>; }
        }

        <span style="color: #0000FF">public</span> TripPoint ReturningFrom
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.returningFrom; }
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.returningFrom = <span style="color: #0000FF">value</span>; }
        }
    }

    [Serializable]
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> TripPoint
    {
        <i style="color: #008000">// fields</i>
        <span style="color: #0000FF">private</span> <span style="color: #0000FF">string</span> airportCode;
        <span style="color: #0000FF">private</span> DateTime date;

        <i style="color: #008000">// constructors</i>
        <span style="color: #0000FF">public</span> TripPoint()
        {}

        <span style="color: #0000FF">public</span> TripPoint(<span style="color: #0000FF">string</span> airportCode, DateTime date)
        {
            <span style="color: #0000FF">this</span>.airportCode = airportCode;
            <span style="color: #0000FF">this</span>.date = date;
        }

        <i style="color: #008000">// properties</i>
        <span style="color: #0000FF">public</span> <span style="color: #0000FF">string</span> AirportCode
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.airportCode; }
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.airportCode = <span style="color: #0000FF">value</span>; }
        }

        <span style="color: #0000FF">public</span> DateTime Date
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.date; }
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.date = <span style="color: #0000FF">value</span>; }
        }
    }

    [Serializable]
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">enum</span> TripMode
    {
        OneWay,
        RoundTrip
    }
}</pre><p>As you can see, <code class="literal">Trip</code> class uses the
    <code class="literal">TripPoint</code> class to represent departure and return,
    which are exposed as <code class="literal">StartingFrom</code> and
    <code class="literal">ReturningFrom</code> properties. It also uses
    <code class="literal">TripMode</code> enumeration to specify whether the trip is one
    way or return trip, which is exposed as <code class="literal">Mode</code>
    property.</p>

    <p>Here is the code-behind class that ties everything
    together:</p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> TripForm : Spring.Web.UI.Page
{
    <i style="color: #008000">// model</i>
    <span style="color: #0000FF">private</span> Trip trip;
    <span style="color: #0000FF">public</span> Trip Trip
    {
        <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> trip; }
        <span style="color: #0000FF">set</span> { trip = <span style="color: #0000FF">value</span>; }
    }

    <i style="color: #008000">// service dependency, injected by Spring IoC container</i>
    <span style="color: #0000FF">private</span> IBookingAgent bookingAgent;
    <span style="color: #0000FF">public</span> IBookingAgent BookingAgent
    {
        <span style="color: #0000FF">set</span> { bookingAgent = <span style="color: #0000FF">value</span>; }
    }

    <i style="color: #008000">// model management methods</i>
    <span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">void</span> InitializeModel()
    {
        trip = <span style="color: #0000FF">new</span> Trip();
        trip.Mode = TripMode.RoundTrip;
        trip.StartingFrom.Date = DateTime.Today;
        trip.ReturningFrom.Date = DateTime.Today.AddDays(1);
    }

    <span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">void</span> LoadModel(<span style="color: #0000FF">object</span> savedModel)
    {
        trip = (Trip) savedModel;
    }

    <span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">object</span> SaveModel()
    {
        <span style="color: #0000FF">return</span> trip;
    }

    <i style="color: #008000">// data binding rules</i>
    <span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">void</span> InitializeDataBindings()
    {
        BindingManager.AddBinding(<span style="color: #A31515">"tripMode.Value"</span>, <span style="color: #A31515">"Trip.Mode"</span>);
        BindingManager.AddBinding(<span style="color: #A31515">"leavingFromAirportCode.SelectedValue"</span>, <span style="color: #A31515">"Trip.StartingFrom.AirportCode"</span>);
        BindingManager.AddBinding(<span style="color: #A31515">"goingToAirportCode.SelectedValue"</span>, <span style="color: #A31515">"Trip.ReturningFrom.AirportCode"</span>);
        BindingManager.AddBinding(<span style="color: #A31515">"departureDate.SelectedDate"</span>, <span style="color: #A31515">"Trip.StartingFrom.Date"</span>);
        BindingManager.AddBinding(<span style="color: #A31515">"returnDate.SelectedDate"</span>, <span style="color: #A31515">"Trip.ReturningFrom.Date"</span>);
    }

    <i style="color: #008000">// event handler for findFlights button, uses injected 'bookingAgent'</i>
    <i style="color: #008000">// service and model 'trip' object to find flights</i>
    <span style="color: #0000FF">private</span> <span style="color: #0000FF">void</span> SearchForFlights(<span style="color: #0000FF">object</span> sender, EventArgs e)
    {
        FlightSuggestions suggestions = bookingAgent.SuggestFlights(trip);
        <span style="color: #0000FF">if</span> (suggestions.HasOutboundFlights)
        {
            <i style="color: #008000">// redirect to SuggestedFlights page</i>
        }
    }
}</pre><p>Note the following about the three preceding pieces of
    code:</p><div class="orderedlist"><ol type="1"><li>
          <p>When the page is initially loaded (<code class="literal">IsPostback ==
          false</code>), the <code class="literal">InitializeModel</code>() method is
          called, which initializes the trip object by creating a new instance
          and setting its properties to desired values. Right before the page
          is rendered, <code class="literal">the SaveModel</code>() method is invoked,
          and the value it returns is stored within the HTTP session. On each
          postback, <code class="literal">the LoadModel()</code> method is called, and
          the value returned by the previous call to
          <code class="literal">SaveModel</code> is passed to <code class="code">SaveModel</code> as
          an argument.</p>

          <p>In this particular case the implementation is very simple
          because our whole model is just the <code class="literal">trip</code> object.
          As such, <code class="literal">SaveModel</code>() simply returns the
          <code class="literal">trip</code> object, and <code class="literal">LoadModel()</code>
          casts the <code class="literal">SaveModel</code>() argument to
          <code class="literal">Trip</code> and assigns it to the
          <code class="literal">trip</code> field within the page. In more complex
          scenarios, the SaveModel() method will typically return a dictionary
          that contains your model objects. Those values will be read from the
          dictionary within the LoadModel() method.</p>
        </li><li>
          <p><code class="literal">InitializeDataBindings</code> method defines the
          binding rules for all of the five input controls on the form. The
          controls are represented by the variables tripMode,
          leavingFromAirportCode, goingToAirportCode, departueDate, and
          returnDate. The binding rules are created by invoking the
          <code class="literal">AddBinding</code> method on the
          <code class="literal">BindingManager</code> exposed by the page. <code class="literal">The
          AddBinding</code> method is heavily overloaded and it allows you
          to specify a <span class="emphasis"><em>binding direction</em></span> and a
          <span class="emphasis"><em>formatter</em></span> to use in addition to the
          <span class="emphasis"><em>source and target binding expressions</em></span> that are
          used above. These optional parameters are discussed later in this
          chapter. For now, focus on the source and target expressions.</p>

          <p>The Spring.NET data binding framework uses Spring.NET
          Expression Language to define binding expressions. In most cases, as
          in the example above, both source and target expression will
          evaluate to a property or a field within one of the controls or a
          data model. This is always the case when you are setting a
          bidirectional binding, as both binding expressions need to be
          "settable". The <code class="literal">InitializeDataBindings</code> method is
          executed only once <span class="emphasis"><em>per page type</em></span>. Basically,
          all binding expressions are parsed the first time the page is
          instantiated, and are then cached and used by all instances of that
          same page type that are created at a later time. This is done for
          performance reasons, as data binding expression parsing on every
          postback is unnecessary and would add a significant overhead to the
          overall page processing time.</p>
        </li><li>
          <p>Notice that the <code class="code">SearchForFlights</code> event handler
          has no dependencies on the view elements. It simply uses the
          injected bookingAgent service and a trip object in order to obtain a
          list of suggested flights. Furthermore, if you make any
          modifications to the trip object within your event handler, bound
          controls are updated accordingly just before the page is
          rendered.</p>

          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
              <p>The lack of view elements in the event handler
              accomplishes one of the major goals we set out to achieve,
              allowing developers to remove view element references from the
              page event handlers and decouple controller-type methods from
              the view.</p>
            </td></tr></table></div>
        </li></ol></div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-binding-detail"></a>22.7.1.&nbsp;Data binding under the hood</h3></div></div></div>
      

      <p>This section describes how data binding is actually implemented,
      the extension points, and additional features that make the data binding
      framework usable in real-world applications.</p>

      <p>The Spring.NET data binding framework revolves around two main
      interfaces: <code class="literal">IBinding</code> and
      <code class="literal">IBindingContainer</code>. The <code class="literal">IBinding</code>
      interface is definitely the more important one of the two, as it has to
      be implemented by all binding types. This interface defines several
      methods, with some of them being overloaded for
      convenience:</p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">interface</span> IBinding
{
    <span style="color: #0000FF">void</span> BindSourceToTarget(<span style="color: #0000FF">object</span> source, <span style="color: #0000FF">object</span> target, ValidationErrors validationErrors);

    <span style="color: #0000FF">void</span> BindSourceToTarget(<span style="color: #0000FF">object</span> source, <span style="color: #0000FF">object</span> target, ValidationErrors validationErrors,
                            IDictionary variables);

    <span style="color: #0000FF">void</span> BindTargetToSource(<span style="color: #0000FF">object</span> source, <span style="color: #0000FF">object</span> target, ValidationErrors validationErrors);

    <span style="color: #0000FF">void</span> BindTargetToSource(<span style="color: #0000FF">object</span> source, <span style="color: #0000FF">object</span> target, ValidationErrors validationErrors,
                            IDictionary variables);

    <span style="color: #0000FF">void</span> SetErrorMessage(<span style="color: #0000FF">string</span> messageId, <span style="color: #0000FF">params</span> <span style="color: #0000FF">string</span>[] errorProviders);
}</pre><p>The <code class="literal">BindSourceToTarget</code> method is used to
      extract and copy bound values from the source object to the target
      object, and <code class="literal">BindTargetToSource</code> does the opposite.
      Both method names and parameter types are generic because the data
      binding framework can be used to bind any two objects. Using it to bind
      web forms to model objects is just one of its possible uses, although a
      very common one and tightly integrated into the Spring.NET Web
      Framework.</p>

      <p>The <code class="literal">ValidationErrors</code> parameter requires further
      explanation. Although the data binding framework is not in any way
      coupled to the data validation framework, they are in some ways related.
      For example, while the data validation framework is best suited to
      validate the populated model according to the business rules, the data
      binding framework is in a better position to validate data types during
      the binding process. However, regardless of where specific validation is
      performed, all error messages should be presented to the user in a
      consistent manner. In order to accomplish this, Spring.NET Web Framework
      passes the same <code class="code">ValidationErrors</code> instance to binding
      methods and to any validators that might be executed within your event
      handlers. This process ensures that all error messages are stored
      together and are displayed consistently to the end user, using
      Spring.NET validation error controls.</p>

      <p>The last method in the <code class="literal">IBinding</code> interface,
      <code class="literal">SetErrorMessage</code>, enables you to specify the resource
      id of the error message to be displayed in case of binding error, as
      well as a list of strings, that server as identifiers to tag error
      messages for the purposes of linking specific error messages to
      locations in the page markup. We wil see an example of the
      <code class="literal">SetErrorMessage</code> usage in a later section.</p>

      <p>The <code class="literal">IBindingContainer</code> interface extends the
      <code class="literal">IBinding</code> interface and adds the following
      members:</p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">interface</span> IBindingContainer : IBinding
{
  <span style="color: #0000FF">bool</span> HasBindings { <span style="color: #0000FF">get</span>; }

  IBinding AddBinding(IBinding binding);
  IBinding AddBinding(<span style="color: #0000FF">string</span> sourceExpression, <span style="color: #0000FF">string</span> targetExpression);
  IBinding AddBinding(<span style="color: #0000FF">string</span> sourceExpression, <span style="color: #0000FF">string</span> targetExpression, BindingDirection direction);
  IBinding AddBinding(<span style="color: #0000FF">string</span> sourceExpression, <span style="color: #0000FF">string</span> targetExpression, IFormatter formatter);
  IBinding AddBinding(<span style="color: #0000FF">string</span> sourceExpression, <span style="color: #0000FF">string</span> targetExpression, BindingDirection direction,
                      IFormatter formatter);
}</pre><p>The <code class="code">IBindingContainer</code> interface has several
      overloaded <code class="literal">AddBinding</code> methods.
      <code class="literal">AddBinding(IBinding binding)</code> is the most generic one,
      as it can be used to add any binding type to the container. The other
      four are convenience methods that provide a simple way to add the most
      commonly used implementation of the
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IBinding</span> interface,
      <code class="literal">SimpleExpressionBinding</code>. The
      <code class="literal">SimpleExpressionBinding</code> was used under the covers in
      the example at the beginning of this section to bind our web form to a
      <code class="literal">Trip</code> instance when calling methods on the property
      <span class="property">BindingManager</span>. Note that the
      <span class="property">BindingManager</span> property is of the type
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IBindingContainer</span>.
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">SimpleExpressionBinding</span> uses Spring.NET
      Expression Language (SpEL) to extract and to set values within source
      and target objects. </p>

      <p>In the TripForm example, the configuration of the BindingManager
      shows the basic usage of how SpEL can be used to specify a
      <code class="literal">sourceExpression</code> and
      <code class="literal">targetExpression</code> arguments. This code section is
      repeated below</p>

      <pre class="programlisting">    protected override void InitializeDataBindings()
    {
        BindingManager.AddBinding("tripMode.Value", "Trip.Mode");
        BindingManager.AddBinding("leavingFromAirportCode.SelectedValue", "Trip.StartingFrom.AirportCode");
        BindingManager.AddBinding("goingToAirportCode.SelectedValue", "Trip.ReturningFrom.AirportCode");
        BindingManager.AddBinding("departureDate.SelectedDate", "Trip.StartingFrom.Date");
        BindingManager.AddBinding("returnDate.SelectedDate", "Trip.ReturningFrom.Date");
    }</pre>

      <p>In this case, the first argument is a
      <code class="literal">sourceExpression</code> evaluated in the context of the page
      itself. The <code class="literal">sourceExpression</code><code class="literal">
      'tripMode.Value' </code> represents the value in the HTML control and
      the<code class="literal"> targetExpression "Trip.Mode"</code> represents the value
      it will be mapped onto whent the page is rendered. When the post-back
      happens values from in <code class="literal">"Trip.Mode"</code> get placed back
      into the HTML control <code class="literal">"tripMode.Value"</code>. This is a
      common case in which bi-directional data mapping is symmetric in terms
      of the <code class="literal">sourceExpression</code> and
      <code class="literal">targetExpression</code> for both the initial rendering of
      the page and when the post-back occurs. There other overloaded methods
      that take <code class="literal">BindingDirection</code> and
      <code class="literal">IFormatter</code> arguments are discussed in the next
      section.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="web-binding-direction"></a>22.7.1.1.&nbsp;Binding direction</h4></div></div></div>
        

        <p>The <code class="code">direction</code> argument determines whether the
        binding is bidirectional or unidirectional. By default, all data
        bindings are bidirectional unless the direction argument is set to
        either <code class="literal">BindingDirection.SourceToTarget</code> or
        <code class="literal">BindingDirection.TargetToSource</code>. If one of these
        values is specified, binding is evaluated only when the appropriate
        <code class="literal">Bind</code><span class="emphasis"><em><code class="code">Direction</code></em></span>
        method is invoked, and is completely ignored in the other direction.
        This configuration is very useful when you want to bind some
        information from the model into non-input controls, such as
        labels.</p>

        <p>However, unidirectional data bindings are also useful when your
        form does not have a simple one-to-one mapping to a presentation
        model. In the earlier trip form example, the presentation model was
        intentionally designed to allow for simple one-to-one mappings. For
        the sake of discussion, let's add the <code class="literal">Airport</code> class
        and modify our <code class="literal">TripPoint</code> class as
        follows:</p><pre class="programlisting"><span style="color: #0000FF">namespace</span> SpringAir.Domain
{
    [Serializable]
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> TripPoint
    {
        <i style="color: #008000">// fields</i>
        <span style="color: #0000FF">private</span> Airport airport;
        <span style="color: #0000FF">private</span> DateTime date;

        <i style="color: #008000">// constructors</i>
        <span style="color: #0000FF">public</span> TripPoint()
        {}

        <span style="color: #0000FF">public</span> TripPoint(Airport airport, DateTime date)
        {
            <span style="color: #0000FF">this</span>.airport = airport;
            <span style="color: #0000FF">this</span>.date = date;
        }

        <i style="color: #008000">// properties</i>
        <span style="color: #0000FF">public</span> Airport Airport
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.airport; }
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.airport = <span style="color: #0000FF">value</span>; }
        }

        <span style="color: #0000FF">public</span> DateTime Date
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.date; }
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.date = <span style="color: #0000FF">value</span>; }
        }
    }

    [Serializable]
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> Airport
    {
        <i style="color: #008000">// fields</i>
        <span style="color: #0000FF">private</span> <span style="color: #0000FF">string</span> code;
        <span style="color: #0000FF">private</span> <span style="color: #0000FF">string</span> name;

       <i style="color: #008000">// properties</i>
        <span style="color: #0000FF">public</span> <span style="color: #0000FF">string</span> Code
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.code; }
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.code = <span style="color: #0000FF">value</span>; }
        }

        <span style="color: #0000FF">public</span> <span style="color: #0000FF">string</span> Name
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.name; }
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.name = <span style="color: #0000FF">value</span>; }
        }
    }
}</pre><p>Instead of the string property <code class="code">AirportCode</code>, our
        <code class="code">TripPoint</code> class now exposes an <code class="code">Airport</code>
        property of type <code class="code">Airport</code>, which is defined in the
        preceding example. What was formerly a simple string-to-string
        binding, with the airport code selected in a dropdown being copied
        directly into the <code class="code">TripPoint.AirportCode</code> property and vice
        versa, now becomes a not-so-simple string-to-Airport binding. So let's
        see how we can solve this mismatch problem of converting a string to
        an Airport instance and an Airport instance to a string.</p>

        <p>Binding from the model to the control, namely the Airport to the
        string, is still very straightforward. You set up one-way bindings
        from the model to controls: The Model-To-Control is represented more
        generally by the enumeration, BindingDirection.TargetToSource.
        </p><pre class="programlisting"><span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">void</span> InitializeDataBindings()
    {
        BindingManager.AddBinding(<span style="color: #A31515">"leavingFromAirportCode.SelectedValue"</span>, <span style="color: #A31515">"Trip.StartingFrom.Airport.Code"</span>, BindingDirection.TargetToSource);
        BindingManager.AddBinding(<span style="color: #A31515">"goingToAirportCode.SelectedValue"</span>, <span style="color: #A31515">"Trip.ReturningFrom.Airport.Code"</span>, BindingDirection.TargetToSource);
        ...
    }</pre><p>You extract the airport code value from the
        <code class="literal">Trip.StartingFrom.Airport.Code</code> instead of
        <code class="literal">Trip.StartingFrom.AirportCode</code> since now the Code in
        encapsulated inside the Airport class. Unfortunately, binding from the
        control to the model the same way won't work, we need a way to create
        an Airport instance from a string. Instead, you need to find an
        instance of the <code class="literal">Airport</code> class based on the airport
        code and set the <code class="literal">TripPoint.Airport</code> property to it.
        Fortunately, Spring.NET data binding makes this simple, especially
        because you already have <code class="literal">airportDao</code> object defined
        in the Spring context (see SpringAir Spring context configuration file
        for details.). The AirportDao has a <code class="literal">GetAirport(string
        airportCode)</code> finder method. You set up data bindings from
        source to target (control-to-model) that will invoke this finder
        method when the page is submitted and the binding infrastructure maps
        the sourceExpression onto the targetExpression.evaluating the source
        expression. </p>

        <p>Our complete set of bindings for these two drop-down lists will
        then look like this:</p><pre class="programlisting"><span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">void</span> InitializeDataBindings()
    {
        BindingManager.AddBinding(<span style="color: #A31515">"@(airportDao).GetAirport(leavingFromAirportCode.SelectedValue)"</span>, <span style="color: #A31515">"Trip.StartingFrom.Airport"</span>, BindingDirection.SourceToTarget);
        BindingManager.AddBinding(<span style="color: #A31515">"leavingFromAirportCode.SelectedValue"</span>, <span style="color: #A31515">"Trip.StartingFrom.Airport.Code"</span>, BindingDirection.TargetToSource);

        BindingManager.AddBinding(<span style="color: #A31515">"@(airportDao).GetAirport(goingToAirportCode.SelectedValue)"</span>, <span style="color: #A31515">"Trip.ReturningFrom.Airport"</span>, BindingDirection.SourceToTarget);
        BindingManager.AddBinding(<span style="color: #A31515">"goingToAirportCode.SelectedValue"</span>, <span style="color: #A31515">"Trip.ReturningFrom.Airport.Code"</span>, BindingDirection.TargetToSource);
        ...
    }</pre><p>By using a pair of bindings for each control, one for
        each direction and using SpEL's feature to reference objects defined
        in the Spring context, you can resolve this data binding issue.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="web-binding-formatters"></a>22.7.1.2.&nbsp;formatter argument</h4></div></div></div>
        

        <p>The last overloaded methods of
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IBindingContainer</span> we need to discuss
        are those that take a <code class="literal">IFormatter</code> argument. is an
        argument to the <code class="literal">AddBinding</code> method. This argument
        allows you to specify a formatter that you use to parse string value
        from the input control before it is bound to the model, and to format
        strongly typed model value before the model is bound to the
        control.</p>

        <p>You typically use one of the formatters provided in the
        Spring.Globalization.Formatters namespace, but if your requirements
        cannot be satisfied by a standard formatter, you can write your own by
        implementing a simple IFormatter interface:</p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">interface</span> IFormatter
{
    <span style="color: #0000FF">string</span> Format(<span style="color: #0000FF">object</span> <span style="color: #0000FF">value</span>);
    <span style="color: #0000FF">object</span> Parse(<span style="color: #0000FF">string</span> <span style="color: #0000FF">value</span>);
}</pre>

        <p>Standard formatters provided with Spring.NET are:
        <code class="literal">CurrencyFormatter</code>,
        <code class="literal">DateTimeFormatter</code>,
        <code class="literal">FloatFormatter</code>,
        <code class="literal">IntegerFormatter</code>,
        <code class="literal">NumberFormatter</code> and
        <code class="literal">PercentFormatter</code>, which are sufficient for most
        usage scenarios.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="web-id-typeconversion"></a>22.7.1.3.&nbsp;Type conversion</h4></div></div></div>
        

        <p>Because the data binding framework uses the same expression
        evaluation engine as the Spring.NET IoC container, it uses any
        registered type converters to perform data binding. Many type
        converters are included with Spring.NET (take a look at the classes in
        Spring.Objects.TypeConverters namespace) and are automatically
        registered for you, but you can implement your own custom converters
        and register them by using standard Spring.NET type converter
        registration mechanisms.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="web-binding-events"></a>22.7.1.4.&nbsp;Data binding events</h4></div></div></div>
        

        <p>Spring.Web's base <code class="literal">Page</code> class adds two events
        to the standard .NET page lifecycle: <code class="literal">DataBound</code> and
        <code class="literal">DataUnbound</code>.</p>

        <p>You can register for an <code class="literal">DataUnbound</code> event
        which will be fired after the data model is updated with values from
        the controls. Specifically, in terms of the Page lifecycle, it is
        fired right after the <code class="literal">Load</code> event and only on
        postbacks, because it not make sense to update the data model with the
        controls' initial values.</p>

        <p>The <code class="literal">DataBound</code> event is fired after controls
        are updated with values from the data model. This event occurs right
        before the <code class="literal">PreRender</code> event.</p>

        <p>The fact that the data model is updated immediately after the
        <code class="literal">Load</code> event and that controls are updated right
        before the <code class="literal">PreRender</code> event means that your event
        handlers can work with a correctly updated data model, as they execute
        after the <code class="literal">Load</code> event, and that any changes you make
        to the data model within event handlers are reflected in the controls
        immediately afterwards, as the controls are updated prior to the
        actual rendering.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="web-binding-errors"></a>22.7.1.5.&nbsp;Rendering binding errors</h4></div></div></div>
        

        <p>If errors occur in the databinding (for example, in trying to
        bind a string 'hello' to an integer property on the model), you can
        specify how those fundamental binding errors should be rendered. The
        following snippet is from the Web Quick Start 'RobustEmployeeInfo'
        example:</p>

        <pre class="programlisting">[Default.aspx.cs]

<span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">void</span> InitializeDataBindings()
{
  <i style="color: #008000">// collect txtId.Text binding errors in "id.errors" collection</i>
  BindingManager.AddBinding(<span style="color: #A31515">"txtId.Text"</span>, <span style="color: #A31515">"Employee.Id"</span>).SetErrorMessage(<span style="color: #A31515">"ID has to be an integer"</span>, <span style="color: #A31515">"id.errors"</span>);
  ...

[Default.aspx]
...
&lt;asp:TextBox ID=<span style="color: #A31515">"txtId"</span> runat=<span style="color: #A31515">"server"</span> /&gt;
&lt;!-- output validation errors from <span style="color: #A31515">"id.errors"</span> collection --&gt;
&lt;spring:ValidationError Provider=<span style="color: #A31515">"id.errors"</span> runat=<span style="color: #A31515">"server"</span> /&gt;
...</pre>

        <p>The SetErrorMessage specifies the message text or resource id of
        the error message to be displayed. This is followed by a a variable
        length list of strings that serve to as a means to assign a friendly
        name to associate with this error should it occur. The same 'tag', or
        error provider name, can be used across different calls to
        'AddBinding'. This is commonly the case if you want to present several
        errors together in the page. In the preceding example, the 'tag' or
        error provider name is "id.errors" will be rendered in Spring's
        ValidationError User Control, for example as shown below in this
        fragment of page markup. Validation controls are discussed more
        extensively in this <a class="link" href="web.html#web-clientscripting" title="22.10.&nbsp;Client-side scripting">section</a>.</p>

        <pre class="programlisting">            &lt;td&gt;
                &lt;asp:TextBox ID="txtId" runat="server" EnableViewState="false" /&gt;
                &lt;spring:ValidationError ID="errId" Provider="id.errors" runat="server" /&gt;&lt;!-- read msg from "id.error" provider --&gt;
            &lt;/td&gt;</pre>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="web-binding-list"></a>22.7.1.6.&nbsp;HttpRequestListBindingContainer</h4></div></div></div>
        

        <p><span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">HttpRequestListBindingContaine</span><span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">r
        </span>extracts posted raw values from the request and populates
        the specified IList by creating objects of the type specified and
        populating each object according to the <code class="code">requestBindings</code>
        collection.</p>

        <p>Please check out the Web Quick Start sample's demo of
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">HttpRequestListBindingContainer</span>. Below is an
        exerpt from that example showing how to use a
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">HttpRequestListBindingContainer</span>.</p>

        <pre class="programlisting"><span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">void</span> InitializeDataBindings()
{
  <i style="color: #008000">// HttpRequestListBindingContainer unbinds specified values from Request -&gt; Productlist</i>
  HttpRequestListBindingContainer requestBindings =
      <span style="color: #0000FF">new</span> HttpRequestListBindingContainer(<span style="color: #A31515">"sku,name,quantity,price"</span>, <span style="color: #A31515">"Products"</span>, <span style="color: #0000FF">typeof</span>(ProductInfo));
  requestBindings.AddBinding(<span style="color: #A31515">"sku"</span>, <span style="color: #A31515">"Sku"</span>);
  requestBindings.AddBinding(<span style="color: #A31515">"name"</span>, <span style="color: #A31515">"Name"</span>);
  requestBindings.AddBinding(<span style="color: #A31515">"quantity"</span>, <span style="color: #A31515">"Quantity"</span>, quantityFormatter);
  requestBindings.AddBinding(<span style="color: #A31515">"price"</span>, <span style="color: #A31515">"Price"</span>, priceFormatter);

  BindingManager.AddBinding(requestBindings);
}</pre>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
           Because browsers do not send the values of unchecked checkboxes, you cannot use HttpRequestListBindingContainer with &lt;input type="checkbox" &gt; html controls. 
        </td></tr></table></div>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-databindingpanel"></a>22.7.2.&nbsp;Using DataBindingPanel</h3></div></div></div>
      

      <p>To simplify use of Spring's Data Binding feature on web pages and
      controls, Spring.Web provides a special
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">DataBindingPanel</span> container control. A
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">DataBindingPanel</span> does not render any html code
      itself, but allows you to define additional, data binding-related
      attributes for its child controls. </p>

      <pre class="programlisting"><span style="color: #A31515">&lt;%@</span> <span style="color: #FF0000">Page</span> <span style="color: #FF0000">Language</span>=<span style="color: #0000FF">"C#"</span> <span style="color: #FF0000">CodeFile</span>=<span style="color: #0000FF">"Default.aspx.cs"</span> <span style="color: #FF0000">Inherits</span>=<span style="color: #0000FF">"DataBinding_EasyEmployeeInfo_Default"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;%@</span> <span style="color: #FF0000">Register</span> <span style="color: #FF0000">TagPrefix</span>=<span style="color: #0000FF">"spring"</span> <span style="color: #FF0000">Namespace</span>=<span style="color: #0000FF">"Spring.Web.UI.Controls"</span> <span style="color: #FF0000">Assembly</span>=<span style="color: #0000FF">"Spring.Web"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;html&gt;</span>
<span style="color: #FF0000">&lt;body&gt;</span>
<span style="color: #FF0000">&lt;spring:DataBindingPanel</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"ctlDataBindingPanel"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;table</span> <span style="color: #FF0000">cellpadding</span>=<span style="color: #0000FF">"3"</span> <span style="color: #FF0000">cellspacing</span>=<span style="color: #0000FF">"3"</span> <span style="color: #FF0000">border</span>=<span style="color: #0000FF">"0"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;tr&gt;</span>
            <span style="color: #A31515">&lt;td&gt;</span>Employee ID:<span style="color: #A31515">&lt;/td&gt;</span>
            <span style="color: #A31515">&lt;td&gt;</span>
                <span style="color: #A31515">&lt;asp:TextBox</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"txtId"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">BindingTarget</span>=<span style="color: #0000FF">"Employee.Id"</span><span style="color: #A31515"> /&gt;</span>              
            <span style="color: #A31515">&lt;/td&gt;</span>
        <span style="color: #A31515">&lt;/tr&gt;</span>
        <span style="color: #A31515">&lt;tr&gt;</span>
            <span style="color: #A31515">&lt;td&gt;</span>First Name:<span style="color: #A31515">&lt;/td&gt;</span>
            <span style="color: #A31515">&lt;td&gt;</span><span style="color: #A31515">&lt;asp:TextBox</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"txtFirstName"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">BindingTarget</span>=<span style="color: #0000FF">"Employee.FirstName"</span><span style="color: #A31515"> /&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
        <span style="color: #A31515">&lt;/tr&gt;</span>
    <span style="color: #A31515">&lt;/table&gt;</span>
<span style="color: #A31515">&lt;/spring.DataBindingPanel&gt;</span>
<span style="color: #A31515">&lt;/body&gt;</span>
<span style="color: #A31515">&lt;/html&gt;</span></pre>

      <p>Using DataBindingPanel, you can specify the binding information
      directly on the control declaration. The following attributes are
      recognized by a DataBindingPanel:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p><code class="code">BindingTarget</code> corresponds to the target
          expression used in IBindingContainer.AddBinding().</p>
        </li><li>
          <p><code class="code">BindingSource</code> corresponds to the source
          expression used in IBindingContainer.AddBinding(). For standard
          controls you don't need to specify the source expression. If you are
          binding to some custom control, of course you must specific this
          attribute.</p>
        </li><li>
          <p><code class="code">BindingDirection</code> is one of the values of the
          BindingDirection enumeration.</p>
        </li><li>
          <p><code class="code">BindingFormatter</code> is the object name of a custom
          formatter. The formatter instance is obtained by a call to
          IApplicationContext.GetObject() each time it is needed.</p>
        </li><li>
          <p><code class="code">BindingType</code> is the type of a completely
          customized binding. Note that a custom binding type must implement
          the following constructor signature:</p>

          <p><code class="literal">ctor(string source,string target, BindingDirection,
          IFormatter)</code></p>
        </li></ul></div>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
         The Visual Studio Web Form Editor complains about binding attributes because it does not recognize them. You can safely ignore those warnings. 
      </td></tr></table></div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e7603"></a>22.7.3.&nbsp;Customizing model persistence</h3></div></div></div>
      

      <p>As mentioned in the chapter introduction, model management needs
      an application developer to override
      <code class="literal">InitializeModel()</code>, <code class="literal">SaveModel() </code>and
      <code class="literal">LoadModel()</code> in order to store model information
      between requests in the user's session. On web farms, storing
      information in a user's session is not a good strategy. You can choose
      another persistence strategy by setting the
      <span class="property">ModelPersistenceMedium</span> property on Spring's base
      Page or UserContorl class (e.g.<span class="property">
      Spring.Web.UI.UserControl)</span></p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"modelPersister"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Sample.DatabaseModelPersistenceMedium, MyCode"</span><span style="color: #A31515">/&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"UserRegistration.aspx"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ModelPersistenceMedium"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"modelPersister"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre><p>To implement any arbitrary persistence
      strategy, implement the IModelPersistenceMedium interface:</p>

      <pre class="programlisting">public interface IModelPersistenceMedium
{
  // Load the model for the specified control context.
  object LoadFromMedium( Control context );

  // Save the specified model object.
  void SaveToMedium( Control context, object modelToSave );
}</pre>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-localization"></a>22.8.&nbsp;Localization and message sources</h2></div></div></div>
    

    <p>Although the .NET framework has excellent localization support, the
    support within ASP.NET 1.x is incomplete. Spring provides support for
    localization in ASP.NET 1.1 apps in the manner of ASP.NET 2.0. Despite the
    initial focus on righer localization for ASP.NET 1.1 applications, using
    Spring's localization features in ASP.NET 2.0 or higher applications does
    provide some useful additional features with a similar programming model,
    such as image localization, push mechansims, and built-in support for user
    culture management via various mechansims. </p>

    <p>Every <code class="literal">.aspx</code> page in an ASP.NET project has a
    resource file associated with it, but those resources are never used by
    the current ASP.NET infrastructure). ASP.NET 2.0 changes this and allow
    application developers to use local resources for pages. In the meantime,
    the Spring.NET team built in to Spring.Web support for using local pages
    resources, thus allowing ASP.NET 1.1 application developers to using
    ASP.NET 2.0-like page resources.</p>

    <p>Spring.Web supports several different approaches to localization
    within a web application, which can be mixed and matched as appropriate.
    You can use push and pull mechanisms, as well as globally defined
    resources when a local resource cannot be found. Spring.Web also supports
    user culture management and image localization, which are described in
    later sections.</p>

    <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
      <p>For introductory information covering ASP.NET globalization and
      localization, see <a class="ulink" href="http://msdn.microsoft.com/asp.net/community/authors/mlb/default.aspx?pull=/library/en-us/dnaspp/html/aspnet-globalarchi.asp" target="_top">Globalization
      Architecture for ASP.NET</a> and <a class="ulink" href="http://www.theserverside.net/articles/showarticle.tss?id=LocalizationPractices" target="_top">Localization
      Practices for ASP.NET 2.0</a> by Michele Leroux Bustamante.</p>
    </td></tr></table></div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-localizers"></a>22.8.1.&nbsp;Working with localizers</h3></div></div></div>
      

      <p>A localizer is an object that implements the
      <code class="literal">Spring.Globalization.ILocalizer</code> interface.
      <code class="literal">Spring.Globalization.AbstractLocalizer</code> is a
      convenient base class for localization: this class has one abstract
      method, <code class="literal">LoadResources</code>. This method must load and
      return a list of all resources that must be automatically applied from
      the resource store.</p>

      <p>To apply resources automatically, a localizer needs to be injected
      into all pages that require automatic resource application. You
      typically accomplish configuration using dependency injection of a page
      base page definition that other page definitions will inherit from. The
      injected localizer inspects the resource file when the page is first
      requested, caches the resources that start with the
      <code class="literal">'$this'</code> marker string value, and applies the values
      to the controls that populate the page prior to the page being
      rendered.</p>

      <p>Spring.NET ships with one concrete implementation of a localizer,
      <code class="literal">Spring.Globalization.Localizers.ResourceSetLocalizer</code>,
      that retrieves a list of resources to apply from the local resource
      file. Future releases of Spring.NET may provide other localizers that
      read resources from an XML file or even from a flat text file that
      contains resource name-value pairs that allow application developers to
      store resources within the files in a web application instead of as
      embedded resources in an assembly. Of course, if an application
      developer prefers to store such resources in a database, the developer
      can write a custom <code class="literal">ILocalizer</code> implementation that
      loads a list of resources to apply from a database.</p>

      <p>You typically configure the localizer to be used within an
      abstract base definition for those pages that require
      localization:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"localizer"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Globalization.Localizers.ResourceSetLocalizer, Spring.Core"</span><span style="color: #A31515">/&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"basePage"</span> <span style="color: #FF0000">abstract</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;description&gt;</span>
        Pages that reference this definition as their parent
        (see examples below) will automatically inherit following properties.
    <span style="color: #A31515">&lt;/description&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Localizer"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"localizer"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <p>Of course, nothing prevents an application developer from defining
      a different localizer for each page in the application; in any case, one
      can always override the localizer defined in a base (page) definition.
      Alternatively, if one does want any resources to be applied
      automatically one can completely omit the localizer definition.</p>

      <p>One last thing to note is that Spring.NET
      <code class="literal">UserControl</code> instances will (by default) inherit the
      localizer and other localization settings from the page that they are
      contained within, but one can similarly also override that behavior
      using explicit dependency injection.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-localization-push"></a>22.8.2.&nbsp;Automatic localization with localizers ("push"
      localization)</h3></div></div></div>
      

      <p>With push localization, an application developer specifies
      localization resources in the resource file for the page, and the
      framework automatically applies those resources to the user controls on
      the page. For example, an application developer could define a page such
      as <code class="literal">UserRegistration.aspx</code>:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;%@</span> <span style="color: #FF0000">Register</span> <span style="color: #FF0000">TagPrefix</span>=<span style="color: #0000FF">"spring"</span> <span style="color: #FF0000">Namespace</span>=<span style="color: #0000FF">"Spring.Web.UI.Controls"</span> <span style="color: #FF0000">Assembly</span>=<span style="color: #0000FF">"Spring.Web"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;%@</span> <span style="color: #FF0000">Page</span> <span style="color: #FF0000">language</span>=<span style="color: #0000FF">"c#"</span> <span style="color: #FF0000">Codebehind</span>=<span style="color: #0000FF">"UserRegistration.aspx.cs"</span>
    <span style="color: #FF0000">AutoEventWireup</span>=<span style="color: #0000FF">"false"</span> <span style="color: #FF0000">Inherits</span>=<span style="color: #0000FF">"ArtFair.Web.UI.Forms.UserRegistration"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;html&gt;</span>
    <span style="color: #FF0000">&lt;body&gt;</span>
        <span style="color: #FF0000">&lt;spring:Content</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"mainContent"</span> <span style="color: #FF0000">contentPlaceholderId</span>=<span style="color: #0000FF">"main"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;div</span> <span style="color: #FF0000">align</span>=<span style="color: #0000FF">"right"</span><span style="color: #A31515">&gt;</span>
                <span style="color: #A31515">&lt;asp:LinkButton</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"english"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">CommandArgument</span>=<span style="color: #0000FF">"en-US"</span><span style="color: #A31515">&gt;</span>English<span style="color: #A31515">&lt;/asp:LinkButton&gt;</span>&amp;nbsp;
                <span style="color: #A31515">&lt;asp:LinkButton</span> <span style="color: #FF0000">ID</span>=<span style="color: #0000FF">"serbian"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">CommandArgument</span>=<span style="color: #0000FF">"sr-SP-Latn"</span><span style="color: #A31515">&gt;</span>Srpski<span style="color: #A31515">&lt;/asp:LinkButton&gt;</span>
            <span style="color: #A31515">&lt;/div&gt;</span>
            <span style="color: #A31515">&lt;table&gt;</span>
                <span style="color: #A31515">&lt;tr&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span><span style="color: #A31515">&lt;asp:Label</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"emailLabel"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">/&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span><span style="color: #A31515">&lt;asp:TextBox</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"email"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">Width</span>=<span style="color: #0000FF">"150px"</span><span style="color: #A31515">/&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;/tr&gt;</span>
                <span style="color: #A31515">&lt;tr&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span><span style="color: #A31515">&lt;asp:Label</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"passwordLabel"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">/&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span><span style="color: #A31515">&lt;asp:TextBox</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"password"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">Width</span>=<span style="color: #0000FF">"150px"</span><span style="color: #A31515">/&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;/tr&gt;</span>
                <span style="color: #A31515">&lt;tr&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span><span style="color: #A31515">&lt;asp:Label</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"passwordConfirmationLabel"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">/&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span><span style="color: #A31515">&lt;asp:TextBox</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"passwordConfirmation"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">Width</span>=<span style="color: #0000FF">"150px"</span><span style="color: #A31515">/&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;/tr&gt;</span>
                <span style="color: #A31515">&lt;tr&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span><span style="color: #A31515">&lt;asp:Label</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"nameLabel"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">/&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                    <span style="color: #A31515">&lt;td&gt;</span><span style="color: #A31515">&lt;asp:TextBox</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"name"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">Width</span>=<span style="color: #0000FF">"150px"</span><span style="color: #A31515">/&gt;</span><span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;/tr&gt;</span>
...

                <span style="color: #A31515">&lt;tr&gt;</span>
                    <span style="color: #A31515">&lt;td</span> <span style="color: #FF0000">colspan</span>=<span style="color: #0000FF">"2"</span><span style="color: #A31515">&gt;</span>
                        <span style="color: #A31515">&lt;asp:Button</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"saveButton"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">/&gt;</span>&amp;nbsp;
                        <span style="color: #A31515">&lt;asp:Button</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"cancelButton"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">/&gt;</span>
                    <span style="color: #A31515">&lt;/td&gt;</span>
                <span style="color: #A31515">&lt;/tr&gt;</span>
            <span style="color: #A31515">&lt;/table&gt;</span>
        <span style="color: #A31515">&lt;/spring:Content&gt;</span>
    <span style="color: #A31515">&lt;/body&gt;</span>
<span style="color: #A31515">&lt;/html&gt;</span></pre>

      <p>In the preceding <code class="literal">.aspx</code> code, none of the
      <code class="literal">Label</code> or <code class="literal">Button</code> controls have had
      a value assigned to the <code class="literal">Text</code> property. The values of
      the <code class="literal">Text</code> property for these controls are stored in
      the local resource file (of the page) using the following convention to
      identify the resource (string).</p>

      <pre class="programlisting">$this.controlId.propertyName</pre>

      <p>The corresponding local resource file,
      <code class="literal">UserRegistration.aspx.resx</code>, is shown below.</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;root&gt;</span>
  <span style="color: #A31515">&lt;data</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"$this.emailLabel.Text"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>Email:<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/data&gt;</span>
  <span style="color: #A31515">&lt;data</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"$this.passwordLabel.Text"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>Password:<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/data&gt;</span>
  <span style="color: #A31515">&lt;data</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"$this.passwordConfirmationLabel.Text"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>Confirm password:<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/data&gt;</span>
  <span style="color: #A31515">&lt;data</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"$this.nameLabel.Text"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>Full name:<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/data&gt;</span>

...

  <span style="color: #A31515">&lt;data</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"$this.countryLabel.Text"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>Country:<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/data&gt;</span>
  <span style="color: #A31515">&lt;data</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"$this.saveButton.Text"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>$messageSource.save<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/data&gt;</span>
  <span style="color: #A31515">&lt;data</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"$this.cancelButton.Text"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>$messageSource.cancel<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/data&gt;</span>
<span style="color: #A31515">&lt;/root&gt;</span></pre>

      <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: Viewing .resx file in Visual Studio 2003"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/admons/tip.png"></td><th align="left">Viewing .resx file in Visual Studio 2003</th></tr><tr><td align="left" valign="top">
        

        <p>To view the .resx file for a page, you may need to enable
        "Project/Show All Files" in Visual Studio. When "Show All Files" is
        enabled, the .resx file appears like a "child" of the code-behind
        page.</p>

        <p>When Visual Studio creates the .resx file, it includes an
        <code class="literal">xds:schema</code> element and several
        <code class="literal">reshead</code> elements. Your data elements will follow
        the <code class="literal">reshead</code> elements. When working with the .resx
        files, you may want to choose "Open With" from the context menu and
        select the "Source Code" text editor.</p>

        <p>There is no way to visually edit resources in a RESX file. Lutz
        Roeder has created a tool named <a class="link" href="http://www.lutzroeder.com/dotnet/" target="_top">Resourcer</a> that you
        can use to edit them</p>
      </td></tr></table></div>

      <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: Creating a .resx file in Visual Studio 2005/8"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/admons/tip.png"></td><th align="left">Creating a .resx file in Visual Studio 2005/8</th></tr><tr><td align="left" valign="top">
        

        <p>To create a resource file in VS 2005, open your control or page
        in design mode and select "Tools/Generate local resource" from the
        menu.</p>
      </td></tr></table></div>

      <p>You must create a localizer for the page to enable automatic
      localization:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"localizer"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Globalization.Localizers.ResourceSetLocalizer, Spring.Core"</span><span style="color: #A31515">/&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"UserRegistration.aspx"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Localizer"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"localizer"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <p>For more information on configuring localizers see <a class="xref" href="web.html#web-localizers" title="22.8.1.&nbsp;Working with localizers">Section&nbsp;22.8.1, &#8220;Working with localizers&#8221;</a></p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-globalresources"></a>22.8.3.&nbsp;Global message sources</h3></div></div></div>
      

      <p>Two resource definitions from the previous section require some
      additional explanation:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;data</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"$this.saveButton.Text"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>$messageSource.save<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/data&gt;</span>
  <span style="color: #A31515">&lt;data</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"$this.cancelButton.Text"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>$messageSource.cancel<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/data&gt;</span></pre>

      <p>In some cases it makes sense to apply a resource that is defined
      <span class="emphasis"><em>globally</em></span> as opposed to locally. In this example, it
      makes better sense to define values for the <code class="literal">Save</code> and
      <code class="literal">Cancel</code> buttons globally as they will probably be used
      throughout the application.</p>

      <p>The above example demonstrates how one can achieve that by
      defining a <span class="emphasis"><em>resource redirection</em></span> expression as the
      value of a local resource by prefixing a global resource name with the
      following string.</p>

      <pre class="programlisting">$messageSource.</pre>

      <p>In the preceding example, this string tells the localizer to use
      the <code class="literal">save</code> and <code class="literal">cancel</code> portions of
      the resource key as lookup keys to retrieve the actual values from a
      global message source. You need to define a resource redirect only
      once, typically in the invariant resource file. Any lookup for a
      resource redirect falls back to the invariant culture, and results in a
      global message source lookup using the correct culture.</p>

      <p>Global resources are (on a per-context basis) defined as a plain
      vanilla object definition using the reserved name of
      <code class="literal">messageSource</code>, which you can add to your Spring.NET
      configuration file:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"messageSource"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.ResourceSetMessageSource, Spring.Core"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ResourceManagers"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;list&gt;</span>
            <span style="color: #A31515">&lt;value&gt;</span>MyApp.Web.Resources.Strings, MyApp.Web<span style="color: #A31515">&lt;/value&gt;</span>
        <span style="color: #A31515">&lt;/list&gt;</span>
    <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: for .NET 2.0 or higher"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/admons/important.png"></td><th align="left">for .NET 2.0 or higher</th></tr><tr><td align="left" valign="top">
        

        <p>To use resources from your App_GlobalResources folder, specify
        <code class="literal">App_GlobalResources</code> as the assembly name:</p>

        <code class="literal">&lt;value&gt;Resources.Strings,
        App_GlobalResources&lt;/value&gt;</code>
      </td></tr></table></div>

      <p>See the SpringAir example application for more. The global
      resources are cached within the Spring.NET
      <code class="literal">IApplicationContext</code> and are accessible through the
      Spring.NET <code class="literal">IMessageSource</code> interface.</p>

      <p>The Spring.Web <code class="literal">Page</code> and
      <code class="literal">UserControl</code> classes have a reference to their owning
      <code class="literal">IApplicationContext</code> and its associated
      <code class="literal">IMessageSource</code>. As such, they automatically redirect
      resource lookups to a global message source if a local resource cannot
      be found.</p>

      <p>Currently, the <code class="literal">ResourceSetMessageSource</code> is the
      only message source implementation that ships with Spring.NET.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-pull-localization"></a>22.8.4.&nbsp;Applying resources manually ("pull" localization)</h3></div></div></div>
      

      <p>Although automatic localization as described above works well for
      many form-like pages, it doesn't work nearly as well for controls
      defined within any iterative controls, because the IDs for such
      iterative controls are not fixed. Nor does automatic localization work
      well if you need to display the same resource multiple times within the
      same page. For example, think of the header columns for outgoing and
      return flights tables within the SpringAir application (see <a class="xref" href="springair.html" title="Chapter&nbsp;41.&nbsp;SpringAir - Reference Application">Chapter&nbsp;41, <i>SpringAir - Reference Application</i></a>).</p>

      <p>These situations call for a pull-style mechanism for localization,
      which is a simple <code class="literal">GetMessage</code> call:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;asp:Repeater</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"outboundFlightList"</span> <span style="color: #FF0000">Runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;HeaderTemplate&gt;</span>
    <span style="color: #A31515">&lt;table</span> <span style="color: #FF0000">border</span>=<span style="color: #0000FF">"0"</span> <span style="color: #FF0000">width</span>=<span style="color: #0000FF">"90%"</span> <span style="color: #FF0000">cellpadding</span>=<span style="color: #0000FF">"0"</span> <span style="color: #FF0000">cellspacing</span>=<span style="color: #0000FF">"0"</span> <span style="color: #FF0000">align</span>=<span style="color: #0000FF">"center"</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"suggestedTable"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;thead&gt;</span>
        <span style="color: #A31515">&lt;tr</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"suggestedTableCaption"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;th</span> <span style="color: #FF0000">colspan</span>=<span style="color: #0000FF">"6"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;%=</span> <span style="color: #FF0000">GetMessage("outboundFlights")</span> <span style="color: #FF0000">%&gt;</span>
          <span style="color: #FF0000">&lt;/th&gt;</span>
        <span style="color: #FF0000">&lt;/tr&gt;</span>
        <span style="color: #FF0000">&lt;tr</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"suggestedTableColnames"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;th&gt;</span><span style="color: #A31515">&lt;%=</span> <span style="color: #FF0000">GetMessage("flightNumber")</span> <span style="color: #FF0000">%&gt;&lt;/th&gt;</span>
          <span style="color: #FF0000">&lt;th&gt;&lt;%</span>= <span style="color: #0000FF">GetMessage("departureDate")</span> <span style="color: #FF0000">%&gt;&lt;/th&gt;</span>
          <span style="color: #FF0000">&lt;th&gt;&lt;%</span>= <span style="color: #0000FF">GetMessage("departureAirport")</span> <span style="color: #FF0000">%&gt;&lt;/th&gt;</span>
          <span style="color: #FF0000">&lt;th&gt;&lt;%</span>= <span style="color: #0000FF">GetMessage("destinationAirport")</span> <span style="color: #FF0000">%&gt;&lt;/th&gt;</span>
          <span style="color: #FF0000">&lt;th&gt;&lt;%</span>= <span style="color: #0000FF">GetMessage("aircraft")</span> <span style="color: #FF0000">%&gt;&lt;/th&gt;</span>
          <span style="color: #FF0000">&lt;th&gt;&lt;%</span>= <span style="color: #0000FF">GetMessage("seatPlan")</span> <span style="color: #FF0000">%&gt;&lt;/th&gt;</span>
        <span style="color: #FF0000">&lt;/tr&gt;</span>
      <span style="color: #FF0000">&lt;/thead&gt;</span>
      <span style="color: #FF0000">&lt;tbody&gt;</span>
  <span style="color: #FF0000">&lt;/HeaderTemplate&gt;</span></pre>

      <p>The <code class="literal">GetMessage</code> method is available within both
      the <code class="literal">Spring.Web.UI.Page </code> and
      <code class="literal">Spring.Web.UI.UserControl</code> classes, and it falls back
      automatically to a global message source lookup if a local resource is
      not found.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-localizing-images"></a>22.8.5.&nbsp;Localizing images within a web application</h3></div></div></div>
      

      <p>Unlike text resources, which can be stored within embedded
      resource files, XML files, or even a database, images in a typical web
      application are usually stored as files on the file system. Using a
      combination of directory naming conventions and a custom ASP.NET
      control, Spring.Web allows you to localize images within the page as
      easily as you do text resources.</p>

      <p>The Spring.Web <code class="literal">Page</code> class exposes the
      <code class="literal">ImagesRoot</code> property, with which you define the root
      directory where images are stored. The default value is Images, which
      means that the localizer expects to find an Images directory within the
      application root. But you can set the property to any value in the
      definition of the page.</p>

      <p>To localize images, you create a directory for each localized
      culture under the <code class="literal">ImagesRoot</code> directory:</p>

      <pre class="programlisting">/MyApp
   /Images
      /en
      /en-US
      /fr
      /fr-CA
      /sr-SP-Cyrl
      /sr-SP-Latn
      ...</pre>

      <p>Once an appropriate folder hierarchy is in place, you put the
      localized images in the appropriate directories and make sure that
      different translations of the same image have the same image name within
      the folders. To place a localized image on a page, you use the
      <code class="literal">&lt;spring:LocalizedImage&gt;</code>:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;%@</span> <span style="color: #FF0000">Page</span> <span style="color: #FF0000">language</span>=<span style="color: #0000FF">"c#"</span> <span style="color: #FF0000">Codebehind</span>=<span style="color: #0000FF">"StandardTemplate.aspx.cs"</span>
                <span style="color: #FF0000">AutoEventWireup</span>=<span style="color: #0000FF">"false"</span> <span style="color: #FF0000">Inherits</span>=<span style="color: #0000FF">"SpringAir.Web.StandardTemplate"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;%@</span> <span style="color: #FF0000">Register</span> <span style="color: #FF0000">TagPrefix</span>=<span style="color: #0000FF">"spring"</span> <span style="color: #FF0000">Namespace</span>=<span style="color: #0000FF">"Spring.Web.UI.Controls"</span> <span style="color: #FF0000">Assembly</span>=<span style="color: #0000FF">"Spring.Web"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;!DOCTYPE</span> <span style="color: #FF0000">HTML</span> <span style="color: #FF0000">PUBLIC</span> <span style="color: #FF0000">"-//W3C//DTD</span> <span style="color: #FF0000">HTML</span> <span style="color: #FF0000">4.0</span> <span style="color: #FF0000">Transitional//EN"</span><span style="color: #A31515"> &gt;</span>
<span style="color: #A31515">&lt;html&gt;</span>
  <span style="color: #A31515">&lt;body&gt;</span>
    <span style="color: #A31515">&lt;spring:LocalizedImage</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"logoImage"</span> <span style="color: #FF0000">imageName</span>=<span style="color: #0000FF">"spring-air-logo.jpg"</span> <span style="color: #FF0000">borderWidth</span>=<span style="color: #0000FF">"0"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515"> /&gt;</span>
  <span style="color: #A31515">&lt;/body&gt;</span>
<span style="color: #A31515">&lt;/html&gt;</span></pre>

      <p>This control will find the most specific directory that contains
      an image with the specified name using standard localization fallback
      rules and the user's culture. For example, if the user's culture is
      <code class="literal">'en-US'</code>, the localizer will look for the
      <code class="literal">spring-air-logo.jpg</code> file in
      <code class="literal">Images/en-US</code>, then in <code class="literal">Images/en</code>
      and finally, if the image file has still not been found, in the root
      <code class="literal">Images</code> directory (which for all practical purposes
      serves as an invariant culture folder).</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-culture"></a>22.8.6.&nbsp;User culture management</h3></div></div></div>
      

      <p>In addition to global and local resource management, Spring.Web
      supports user culture management by exposing the current
      <code class="literal">CultureInfo</code> through the
      <code class="literal">UserCulture</code> property on the <code class="literal">Page</code>
      and <code class="literal">UserControl</code> classes.</p>

      <p>The <code class="literal">UserCulture</code> property delegates culture
      resolution to an implementation of the
      <code class="literal">Spring.Globalization.ICultureResolver</code> interface. You
      specify the culture resolver to use by configuring the
      <code class="literal">CultureResolver</code> property of the
      <code class="literal">Page</code> class in the relevant object definition:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"BasePage"</span> <span style="color: #FF0000">abstract</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"CultureResolver"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Globalization.Resolvers.CookieCultureResolver, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <p>Several useful implementations of
      <code class="literal">ICultureResolver</code> ship as part of Spring.Web, so it is
      unlikely that application developers need to implement their own culture
      resolver. However, you do need to implement your own culture resolver,
      the resulting implementation should be fairly straightforward as you
      need to implement only two methods. The following sections discuss each
      available implementation of the <code class="literal">ICultureResolver</code>
      interface.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e7749"></a>22.8.6.1.&nbsp;DefaultWebCultureResolver</h4></div></div></div>
        

        <p><code class="methodname">DefaultWebCultureResolver</code>, the default
        culture resolver implementation, is used if you do not specify a
        culture resolver for a page, or if you inject a
        <code class="literal">DefaultWebCultureResolver</code> into a page definition
        explicitly. The latter case (explicit injection) is sometimes useful
        because you can specify a culture that should always be used, by
        defining the <code class="literal">DefaultCulture</code> property on the
        resolver.</p>

        <p>The <code class="literal">DefaultWebCultureResolver</code> looks first at
        the <code class="literal">DefaultCulture</code> property and return its value if
        said property value is not null. If it is null, the
        <code class="literal">DefaultWebCultureResolver</code> falls back to request
        header inspection. If no <code class="literal">'Accept-Lang'</code> request
        headers are present , the resolver returns the UI culture of the
        currently executing thread.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e7760"></a>22.8.6.2.&nbsp;RequestCultureResolver</h4></div></div></div>
        

        <p>The RequestCultureResolver resolver operates similar to the
        <code class="literal">DefaultWebCultureResolver</code>, except that it always
        checks request headers <span class="emphasis"><em>first</em></span>, and only then falls
        back to the value of the <code class="literal">DefaultCulture</code> property or
        the culture code of the current thread.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e7766"></a>22.8.6.3.&nbsp;SessionCultureResolver</h4></div></div></div>
        

        <p>The <code class="methodname">SessionCultureResolver</code> resolver
        looks for culture information in the user's session and returns the
        information if it finds it. If not,
        <code class="methodname">SessionCultureResolver</code> falls back to the
        behavior of the <code class="literal">DefaultWebCultureResolver</code>.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e7772"></a>22.8.6.4.&nbsp;CookieCultureResolver</h4></div></div></div>
        

        <p>This resolver looks for culture information in a cookie, and
        return it if it finds one. If not, it falls back to the behavior of
        the <code class="literal">DefaultWebCultureResolver</code>.</p>

        <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/admons/warning.png"></td><th align="left">Warning</th></tr><tr><td align="left" valign="top">
          <p><code class="literal">CookieCultureResolver</code> does not work if your
          application uses <code class="literal">localhost</code> as the server URL,
          which is a typical setting in a development environment.</p>

          <p>To work around this limitation, use
          <code class="literal">SessionCultureResolver</code> during development and
          switch to <code class="literal">CookieCultureResolver</code> before you deploy
          the application in a production. This is easily accomplished in
          Spring.Web (simply change the config file) but is something that you
          should be aware of.</p>
        </td></tr></table></div>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-culture-changing"></a>22.8.7.&nbsp;Changing cultures</h3></div></div></div>
      

      <p>To change the culture, application developers need to define one
      of the culture resolvers that support culture changes, such as
      <code class="literal">SessionCultureResolver</code> or
      <code class="literal">CookieCultureResolver</code> in the Spring application
      context. For example, </p>

      <p> You also can write a custom <code class="literal">ICultureResolver</code>
      that persists culture information in a database, as part of a user's
      profile.</p>

      <pre class="programlisting">  &lt;object id="cultureResolver" type="Spring.Globalization.Resolvers.SessionCultureResolver, Spring.Web" /&gt;</pre>

      <p>Once that requirement is satisfied, you set the
      <code class="literal">UserCulture</code> property to a new
      <code class="literal">CultureInfo</code> object before the page is rendered. In
      the following <code class="literal">.aspx</code> example, two link buttons can be
      used to change the user's culture. In the code-behind, this is all one
      need do to set the new culture. A code snippet for the code-behind file
      (<code class="literal">UserRegistration.aspx.cs</code>) is shown below.</p>

      <pre class="programlisting"><span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">void</span> OnInit(EventArgs e)
{
    InitializeComponent();

    <span style="color: #0000FF">this</span>.english.Command += <span style="color: #0000FF">new</span> CommandEventHandler(<span style="color: #0000FF">this</span>.SetLanguage);
    <span style="color: #0000FF">this</span>.serbian.Command += <span style="color: #0000FF">new</span> CommandEventHandler(<span style="color: #0000FF">this</span>.SetLanguage);

    <span style="color: #0000FF">base</span>.OnInit(e);
}

<span style="color: #0000FF">private</span> <span style="color: #0000FF">void</span> SetLanguage(<span style="color: #0000FF">object</span> sender, CommandEventArgs e)
{
    <span style="color: #0000FF">this</span>.UserCulture = <span style="color: #0000FF">new</span> CultureInfo((<span style="color: #0000FF">string</span>) e.CommandArgument);
}</pre>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-resultmapping"></a>22.9.&nbsp;Result mapping</h2></div></div></div>
    

    <p>In many ASP.NET applications, no built-in way exists to externalize
    the flow of the application. The most common way of defining application
    flow is by hardcoding calls to the <code class="literal">Response.Redirect</code>
    and <code class="literal">Server.Transfer</code> methods within event
    handlers.</p>

    <p>This approach is problematic because any changes to the flow of an
    application necessitates code changes (with the attendant recompilation,
    testing, redeployment, and so on). A better way, which works in many MVC (
    <a class="ulink" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnpatterns/html/DesMVC.asp" target="_top">Model-View-Controller</a>)
    web frameworks, is to enable you to externalize the mapping of action
    results to target pages.</p>

    <p>Spring.Web adds this functionality to ASP.NET by allowing you to
    define result mappings within the definition of a page, and to then simply
    use logical result names within event handlers to control application
    flow.</p>

    <p>In Spring.Web, a logical result is encapsulated and defined by the
    <code class="literal">Result</code> class; thus you can configure results like any
    other object:</p>

    <pre class="programlisting">
<span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>

    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"homePageResult"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.Result, Spring.Web"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetPage"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"~/Default.aspx"</span><span style="color: #A31515">/&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Mode"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Transfer"</span><span style="color: #A31515">/&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Parameters"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;dictionary&gt;</span>
                <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"literal"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"My Text"</span><span style="color: #A31515">/&gt;</span>
                <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"name"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"%{UserInfo.FullName}"</span><span style="color: #A31515">/&gt;</span>
                <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"host"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"%{Request.UserHostName}"</span><span style="color: #A31515">/&gt;</span>
            <span style="color: #A31515">&lt;/dictionary&gt;</span>
        <span style="color: #A31515">&lt;/property&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>

    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"loginPageResult"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Support.Result, Spring.Web"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetPage"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Login.aspx"</span><span style="color: #A31515">/&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Mode"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Redirect"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>

    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"UserRegistration.aspx"</span> <span style="color: #FF0000">parent</span>=<span style="color: #0000FF">"basePage"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"UserManager"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"userManager"</span><span style="color: #A31515">/&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Results"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;dictionary&gt;</span>
                <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"userSaved"</span> <span style="color: #FF0000">value-ref</span>=<span style="color: #0000FF">"homePageResult"</span><span style="color: #A31515">/&gt;</span>
                <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"cancel"</span> <span style="color: #FF0000">value-ref</span>=<span style="color: #0000FF">"loginPageResult"</span><span style="color: #A31515">/&gt;</span>
            <span style="color: #A31515">&lt;/dictionary&gt;</span>
        <span style="color: #A31515">&lt;/property&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;/objects&gt;</span>
</pre>

    <p>The only property for which you <span class="emphasis"><em>must</em></span> supply a
    value for each result is the <code class="literal">TargetPage</code> property. The
    value of the <code class="literal">Mode</code> property can be
    <code class="literal">Transfer</code>, <code class="literal">TransferNoPreserve</code>,
    or<code class="literal"> Redirect</code>, and defaults to
    <code class="literal">Transfer</code> if none is specified.
    <span class="property">TransferNoPreserve</span> issues a server-side transfer with
    'preserveForm=false', so that QueryString and Form data are not
    preserved.</p>

    <p>If your target page requires parameters, you can define them with
    the <code class="literal">Parameters</code> dictionary property. You specify literal
    values or <a class="link" href="expressions.html" title="Chapter&nbsp;11.&nbsp;Expression Evaluation">object navigation expressions</a>
    for such parameter values. An expression is evaluated in the context of
    the page in which the result is being referenced. In the preceding
    example, any page that uses the <code class="literal">homePageResult</code> needs to
    expose a <code class="literal">UserInfo</code> property on the page class
    itself.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p>In Spring.NET 1.1.0 and earlier, the prefix indicated an object
        navigation expression in the <code class="literal">Parameters</code> dictionary
        property was the dollar sign, for example,
        <code class="literal">${UserInfo.FullName}.</code>This convention conflicted
        with the prefix used to perform property replacement, the dollar sign,
        as described in the section <a class="link" href="objects.html#objects-factory-placeholderconfigurer" title="5.9.2.1.&nbsp;Example: The PropertyPlaceholderConfigurer">PropertyPlaceholderConfigurer</a>.
        As a workaround you can differentiate the prefix and suffix used in
        <span class="property">PropertyPlaceholderConfigurer</span>, for example prefix
        = $${ and suffix = }. In Spring. NET 1.1.1, a new prefix character,
        the percent sign (i.e.<code class="literal">%{UserInfo.FullName}</code>.) can be
        used in the <code class="literal">Parameters</code> dictionary to avoid this
        conflict , so you can keep the familiar NAnt style
        PropertyPlaceholderConfigurer defaults.</p>
      </td></tr></table></div>

    <p>Parameters are handled differently depending on the result mode. For
    redirect results, every parameter is converted to a string, then URL
    encoded, and finally appended to a redirect query string. Parameters for
    transfer results are added to the <code class="literal">HttpContext.Items</code>
    collection before the request is transferred to the target page. Transfers
    are more flexible because any object can be passed as a parameter between
    pages. They are also more efficient because they don't require a
    round-trip to the client and back to the server, so transfer mode is
    recommended as the preferred result mode (it is also the current
    default).</p>

    <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/admons/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top">
      <p>If you need to customize how a redirect request is generated, for
      example, to encrypt the request parameters, subclass the Request object
      and override one or more protected methods, for example <code class="literal">string
      BuildUrl( string resolvedPath, IDictionary resolvedParameters
      )</code>. See the API documentation for additional
      information.</p>
    </td></tr></table></div>

    <p>The preceding example shows independent result object definitions,
    which are useful for global results such as a home- and login- page.
    <code class="literal">Result</code> definitions are only used by one page should be
    simply embedded within the definition of a page, either as inner object
    definitions or using a special shortcut notation for defining a result
    definition:</p>

    <pre class="programlisting">
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"~/UI/Forms/UserRegistration.aspx"</span> <span style="color: #FF0000">parent</span>=<span style="color: #0000FF">"basePage"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"UserManager"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"userManager"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>

  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Results"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;dictionary&gt;</span>
      <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"userSaved"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"redirect:UserRegistered.aspx?status=Registration Successful,user=${UserInfo}"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"cancel"</span> <span style="color: #FF0000">value-ref</span>=<span style="color: #0000FF">"homePageResult"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/dictionary&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>
</pre>

    <p>The short notation for the result must adhere to the following
    format...</p>

    <pre class="programlisting">[&lt;mode&gt;:]&lt;targetPage&gt;[?param1,param2,...,paramN]</pre>

    <p>Possible values for the <code class="literal">mode</code> value referred to in
    the preceding notation snippet:</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><code class="literal">redirect</code>: calls
        Response.Redirect(string)</p>
      </li><li>
        <p><code class="literal">redirectNoAbort</code>: calls
        Response.Redirect(string, false)</p>
      </li><li>
        <p><code class="literal">transfer</code>: calls
        Server.Transfer(string)</p>
      </li><li>
        <p><code class="literal">TransferNoPreserve</code>: calls
        Server.Transfer(string, false)</p>
      </li></ul></div>

    <p>These values correspond to the values of the ResultMode enumeration.
    A comma separates parameters instead of an ampersand; this avoids
    laborious ampersand escaping within an XML object definition. The use of
    the ampersand character is still supported if required, but you then have
    to specify the ampersand character using the well known &amp; entity
    reference.</p>

    <p>After you define your results, you can use them within the event
    handlers of your pages
    (<code class="literal">UserRegistration.apsx.cs</code>):</p>

    <pre class="programlisting"><span style="color: #0000FF">private</span> <span style="color: #0000FF">void</span> SaveUser(<span style="color: #0000FF">object</span> sender, EventArgs e)
{
    UserManager.SaveUser(UserInfo);
    SetResult(<span style="color: #A31515">"userSaved"</span>);
}

<span style="color: #0000FF">public</span> <span style="color: #0000FF">void</span> Cancel(<span style="color: #0000FF">object</span> sender, EventArgs e)
{
    SetResult(<span style="color: #A31515">"cancel"</span>);
}

<span style="color: #0000FF">protected</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">void</span> OnInit(EventArgs e)
{
    InitializeComponent();

    <span style="color: #0000FF">this</span>.saveButton.Click += <span style="color: #0000FF">new</span> EventHandler(<span style="color: #0000FF">this</span>.SaveUser);
    <span style="color: #0000FF">this</span>.cancelButton.Click += <span style="color: #0000FF">new</span> EventHandler(<span style="color: #0000FF">this</span>.Cancel);

    <span style="color: #0000FF">base</span>.OnInit(e);
}</pre>

    <p>You can further refactor the preceding example and use defined
    constants, which is advisable when a logical result name such as "home" is
    likely to be referenced by many pages.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-resultmapping-custom"></a>22.9.1.&nbsp;Registering user defined transfer modes</h3></div></div></div>
      

      <p>You can also register a custom interpreter that can parse the
      shorthand string representation that creates a Result object. To do this
      you should view the result mapping string representation as consisting
      of two parts:</p>

      <pre class="programlisting">&lt;resultmode&gt;:&lt;textual result representation&gt;</pre>

      <p>The interface <code class="literal">IResultFactory</code> is responsible for
      creating an IResult object from these two pieces:</p>

      <pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">interface</span> IResultFactory
{
    IResult CreateResult( <span style="color: #0000FF">string</span> resultMode, <span style="color: #0000FF">string</span> resultText );
}</pre>

      <p>You use a <code class="literal">ResultFactoryRegistry</code> to associate a
      given resultmode string with an <code class="literal">IResultFactory</code>
      implementation:</p>

      <pre class="programlisting"><span style="color: #0000FF">class</span> MySpecialResultLogic : IResult
{
  ...
}

<span style="color: #0000FF">class</span> MySpecialResultLogicFactory : IResultFactory
{
   IResult Create( <span style="color: #0000FF">string</span> mode, <span style="color: #0000FF">string</span> expression ) {
     <i style="color: #008000">/* ... convert 'expression' into MySpecialResultLogic */</i>
   }
}

<i style="color: #008000">// register with global factory</i>
ResultFactoryRegistry.RegisterResultFactory( <span style="color: #A31515">"mySpecialMode"</span>, <span style="color: #0000FF">new</span> MySpecialResultLogicFactory );
</pre>

      <p>You then use the custom <span class="property">continue</span> mode in your
      page:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;--</span> <span style="color: #FF0000">configure</span> <span style="color: #FF0000">your</span> <span style="color: #FF0000">Results</span> <span style="color: #FF0000">--&gt;</span>
<span style="color: #FF0000">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"mypage.aspx"</span><span style="color: #A31515">&gt;</span>
   <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Results"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;dictionary&gt;</span>
         <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"continue"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"mySpecialMode:&lt;some MySpecialResultLogic string representation&gt;"</span><span style="color: #A31515"> /&gt;</span>
      <span style="color: #A31515">&lt;/dictionary&gt;</span>
   <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <p>The result redirection is done as before, by calling
      <code class="literal">myPage.SetResult("cancel");</code></p>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-clientscripting"></a>22.10.&nbsp;Client-side scripting</h2></div></div></div>
    

    <p>ASP.NET supports client-side scripting through the use of the
    <code class="literal">Page.RegisterClientScriptBlock</code> and
    <code class="literal">Page.RegisterStartupScript</code> methods. However, neither
    method allows you to output a registered script markup within a
    <code class="literal">&lt;head&gt;</code> section of a page, which in many cases is
    exactly what you need to do.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-scripthead"></a>22.10.1.&nbsp;Registering scripts within the head HTML section</h3></div></div></div>
      

      <p>Spring.Web adds several methods to enhance client-side scripting
      to the base <code class="literal">Spring.Web.UI.Page</code> class:
      <code class="literal">RegisterHeadScriptBlock</code> and
      <code class="literal">RegisterHeadScriptFile</code>, each with a few overrides.
      You can call these methods from your custom pages and controls in order
      to register script blocks and script files that must be included in the
      <code class="literal">&lt;head&gt;</code> section of the final HTML page.</p>

      <p>You must use the <code class="literal">&lt;spring:Head&gt;</code>
      server-side control to define your <code class="literal">&lt;head&gt;</code>
      section instead of using the standard HTML
      <code class="literal">&lt;head&gt;</code> element. This is shown below.</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;%@</span> <span style="color: #FF0000">Page</span> <span style="color: #FF0000">language</span>=<span style="color: #0000FF">"c#"</span> <span style="color: #FF0000">Codebehind</span>=<span style="color: #0000FF">"StandardTemplate.aspx.cs"</span>
                <span style="color: #FF0000">AutoEventWireup</span>=<span style="color: #0000FF">"false"</span> <span style="color: #FF0000">Inherits</span>=<span style="color: #0000FF">"SpringAir.Web.StandardTemplate"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;%@</span> <span style="color: #FF0000">Register</span> <span style="color: #FF0000">TagPrefix</span>=<span style="color: #0000FF">"spring"</span> <span style="color: #FF0000">Namespace</span>=<span style="color: #0000FF">"Spring.Web.UI.Controls"</span> <span style="color: #FF0000">Assembly</span>=<span style="color: #0000FF">"Spring.Web"</span> <span style="color: #FF0000">%&gt;</span>
<span style="color: #FF0000">&lt;!DOCTYPE</span> <span style="color: #FF0000">HTML</span> <span style="color: #FF0000">PUBLIC</span> <span style="color: #FF0000">"-//W3C//DTD</span> <span style="color: #FF0000">HTML</span> <span style="color: #FF0000">4.0</span> <span style="color: #FF0000">Transitional//EN"</span><span style="color: #A31515"> &gt;</span>
<span style="color: #A31515">&lt;html&gt;</span>
  <span style="color: #A31515">&lt;spring:Head</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"Head1"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;title&gt;</span>
      <span style="color: #A31515">&lt;spring:ContentPlaceHolder</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"title"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;%=</span> <span style="color: #FF0000">GetMessage("default.title")</span> <span style="color: #FF0000">%&gt;</span>
      <span style="color: #FF0000">&lt;/spring:ContentPlaceHolder&gt;</span>
    <span style="color: #FF0000">&lt;/title&gt;</span>
    <span style="color: #FF0000">&lt;LINK</span> <span style="color: #FF0000">href</span>=<span style="color: #0000FF">"&lt;%= CssRoot %&gt;/default.css"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"text/css"</span> <span style="color: #FF0000">rel</span>=<span style="color: #0000FF">"stylesheet"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;spring:ContentPlaceHolder</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"head"</span> <span style="color: #FF0000">runat</span>=<span style="color: #0000FF">"server"</span><span style="color: #A31515">&gt;</span><span style="color: #A31515">&lt;/spring:ContentPlaceHolder&gt;</span>
  <span style="color: #A31515">&lt;/spring:Head&gt;</span>
  <span style="color: #A31515">&lt;body&gt;</span>
  ...
  <span style="color: #A31515">&lt;/body&gt;</span>
<span style="color: #A31515">&lt;/html&gt;</span></pre>

      <p>The preceding example above shows how you typically set-up a
      <code class="literal">&lt;head&gt;</code> section within a master page template to
      be able to change the title value and to add additional elements to the
      <code class="literal">&lt;head&gt;</code> section from the child pages using
      <code class="literal">&lt;spring:ContentPlaceholder&gt;</code> controls. However,
      only the <code class="literal">&lt;spring:Head&gt;</code> declaration is required
      in order for Spring.NET <code class="literal">Register*</code> scripts to work
      properly.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-scriptcss"></a>22.10.2.&nbsp;Adding CSS definitions to the head section</h3></div></div></div>
      

      <p>In a similar fashion, you can add references to CSS files, or even
      specific styles, directly to the <code class="literal">&lt;head&gt;</code> HTML
      section using <code class="literal">Page.RegisterStyle</code> and
      <code class="literal">Page.RegisterStyleFile</code> methods. The latter one simply
      allows you to include a reference to an external CSS file, while the
      former one allows you to define embedded style definitions by specifying
      the style name and definition as the parameters. The final list of style
      definitions registered this way will be rendered within the single
      embedded <code class="literal">style</code> section of the final HTML
      document.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-wellknowdirectory"></a>22.10.3.&nbsp;Well-known directories</h3></div></div></div>
      

      <p>To make the manual inclusion of client-side scripts, CSS files and
      images easier, the Spring.Web <code class="literal">Page</code> class exposes
      several properties that help you reference such artifacts with absolute
      paths. This capability gives web application developers convenience
      functionality straight out of the box if they stick to common
      conventions such as a web application (directory) structure.</p>

      <p>These properties are <code class="literal">ScriptsRoot</code>,
      <code class="literal">CssRoot</code> and <code class="literal">ImagesRoot</code>. They have
      default values of <code class="literal">Scripts</code>, <code class="literal">CSS</code> and
      <code class="literal">Images</code>, which work well if you create and use these
      directories in your web application root. However, if you prefer to
      place them somewhere else, you can always override default values by
      injecting new values into your page definitions (you will typically
      inject these values only in the base page definition, as they are
      normally shared by all the pages in the application). An example of such
      configuration is shown below:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"basePage"</span> <span style="color: #FF0000">abstract</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;description&gt;</span>
        Convenience base page definition for all the pages.

        Pages that reference this definition as their parent (see the examples below)
        will automatically inherit the following properties....

    <span style="color: #A31515">&lt;/description&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"CssRoot"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Web/CSS"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ImagesRoot"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Web/Images"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>
</pre>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="web-usercontrols"></a>22.11.&nbsp;Spring user controls</h2></div></div></div>
    

    <p>Spring provides several custom user controls that are located in the
    <code class="literal">Spring.Web.UI.Controls</code> namespace. This section lists
    the controls and points to other documentation to provide additional
    information. Check the SDK docs for descriptions of controls that are not
    mentioned here.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web-validation-controls"></a>22.11.1.&nbsp;Validation controls</h3></div></div></div>
      

      <p>You can specify the location in the web page where validation
      errors are to be rendered by using the
      <code class="literal">ValidationSummary</code> and
      <code class="literal">ValidationError</code> controls. Two controls exist because
      they have different defaults for how errors are rendered.
      <code class="literal">ValidationSummary</code> is used to display potentially
      multiple errors identified by the validation framework.
      <code class="literal">ValidationError</code> is used to display field-level
      validation errors. Please refer to the section <a class="link" href="validation.html#validation-aspnet-usage" title="12.8.&nbsp;Usage tips within ASP.NET">ASP.NET usage tips</a> in the
      chapter on the <a class="link" href="validation.html" title="Chapter&nbsp;12.&nbsp;Validation Framework">Validation Framework</a>
      more information.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e7932"></a>22.11.2.&nbsp;Databinding controls</h3></div></div></div>
      

      <p>Some standard controls are not easy to use with Spring's
      databinding support. Examples are check boxes and ratio button groups.
      Here you should use the <code class="literal">CheckBoxList</code> and
      <code class="literal">RadioButtonGroup</code> controls. You can do databinding
      itself by using the <a class="link" href="web.html#web-databindingpanel" title="22.7.2.&nbsp;Using DataBindingPanel">DataBindingPanel</a> instead of the
      using the BindingManager API within the code behind page.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e7938"></a>22.11.3.&nbsp;Calendar control</h3></div></div></div>
      

      <p>A pop-up DHTML calendar control is provided. It is a slightly
      modified version of the <a class="ulink" href="http://www.dynarch.com/projects/calendar" target="_top">Dynarch.com DHTML
      Calendar</a> control written by Mihai Bazon.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e7942"></a>22.11.4.&nbsp;Panel control</h3></div></div></div>
      

      <p>You can suppress dependency injection for controls inside your
      ASP.NET by using the Panel control. See <a class="link" href="web.html#web-controlling-di" title="22.4.5.&nbsp;Customizing control dependency injection">Customizing control dependency
      injection</a> .</p>
    </div>
  </div>
</div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="navfooter"><hr></hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="spring-web.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ajax.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Part&nbsp;III.&nbsp;The Web&nbsp;</td><td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.springsource.com/" title="SpringSource">Sponsored by SpringSource</a></span></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;23.&nbsp;ASP.NET AJAX</td></tr></table></div></body></html>